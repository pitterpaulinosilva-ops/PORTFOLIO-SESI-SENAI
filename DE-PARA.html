<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análise De-Para do Portfólio de Processos Sesi/Senai 2024-2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.1/jspdf.plugin.autotable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;500;600&display=swap" rel="stylesheet">
    <!-- Enhanced Visual Design with Modern Color Palette -->
    <style>
        :root {
            /* Primary Colors - FIEA Blue */
            --primary-50: #e6f2ff;
            --primary-100: #b3d9ff;
            --primary-200: #80c0ff;
            --primary-300: #4da7ff;
            --primary-400: #1a8eff;
            --primary-500: #004c98;        /* Azul FIEA institucional */
            --primary-600: #003d7a;
            --primary-700: #002e5c;
            --primary-800: #001f3e;
            --primary-900: #001020;
            
            /* Neutral Colors - FIEA Palette */
            --neutral-50: #FFFFFF;         /* Branco puro */
            --neutral-100: #F6F6F6;        /* Cinza claro FIEA */
            --neutral-200: #E0E0E0;        /* Cinza claro para bordas */
            --neutral-300: #CCCCCC;        /* Cinza médio */
            --neutral-400: #999999;        /* Cinza médio escuro */
            --neutral-500: #666666;        /* Cinza escuro */
            --neutral-600: #4d4d4d;        /* Cinza mais escuro */
            --neutral-700: #333333;        /* Cinza muito escuro */
            --neutral-800: #212121;        /* Cinza escuro FIEA */
            --neutral-900: #1a1a1a;        /* Quase preto */
            
            /* Status Colors */
            --success-50: #f0fdf4;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --warning-50: #fffbeb;
            --warning-500: #f59e0b;
            --warning-600: #d97706;
            --error-50: #fef2f2;
            --error-500: #ef4444;
            --error-600: #dc2626;
            
            /* Shadows */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
            
            /* Border Radius */
            --radius-sm: 0.375rem;
            --radius-md: 0.5rem;
            --radius-lg: 0.75rem;
            --radius-xl: 1rem;
            
            /* Theme Variables - FIEA Palette */
            --bg-primary: #FFFFFF;        /* Branco - Fundo principal */
            --bg-secondary: #F6F6F6;      /* Cinza claro - Cards e destaques */
            --bg-tertiary: #F6F6F6;       /* Cinza claro - Áreas secundárias */
            --text-primary: #212121;      /* Cinza escuro - Texto principal */
            --text-secondary: #004c98;    /* Azul FIEA - Títulos e destaques */
            --text-tertiary: #666666;     /* Cinza médio - Texto secundário */
            --border-primary: #E0E0E0;    /* Cinza claro para bordas */
            --border-secondary: #CCCCCC;  /* Cinza médio para bordas */
        }
        
        [data-theme="dark"] {
            /* Primary Colors - FIEA Blue Dark Theme */
            --primary-50: #001020;
            --primary-100: #001f3e;
            --primary-200: #002e5c;
            --primary-300: #003d7a;
            --primary-400: #004c98;        /* Azul FIEA institucional */
            --primary-500: #1a8eff;
            --primary-600: #4da7ff;
            --primary-700: #80c0ff;
            --primary-800: #b3d9ff;
            --primary-900: #e6f2ff;
            
            /* Neutral Colors - FIEA Dark Theme */
            --neutral-50: #1a1a1a;         /* Quase preto */
            --neutral-100: #212121;        /* Cinza escuro FIEA */
            --neutral-200: #333333;        /* Cinza muito escuro */
            --neutral-300: #4d4d4d;        /* Cinza mais escuro */
            --neutral-400: #666666;        /* Cinza escuro */
            --neutral-500: #999999;        /* Cinza médio escuro */
            --neutral-600: #CCCCCC;        /* Cinza médio */
            --neutral-700: #E0E0E0;        /* Cinza claro para bordas */
            --neutral-800: #F6F6F6;        /* Cinza claro FIEA */
            --neutral-900: #FFFFFF;        /* Branco puro */
            
            /* Status Colors - Dark Theme */
            --success-50: #14532d;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --warning-50: #78350f;
            --warning-500: #f59e0b;
            --warning-600: #d97706;
            --error-50: #7f1d1d;
            --error-500: #ef4444;
            --error-600: #dc2626;
            
            /* Shadows - Dark Theme */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.3);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.4), 0 2px 4px -2px rgb(0 0 0 / 0.3);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.4), 0 4px 6px -4px rgb(0 0 0 / 0.3);
            --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.4), 0 8px 10px -6px rgb(0 0 0 / 0.3);
            
            /* Dark Theme Variables - FIEA Palette Adapted */
            --bg-primary: #1a1a1a;        /* Escuro suave */
            --bg-secondary: #2a2a2a;      /* Cinza escuro para cards */
            --bg-tertiary: #333333;       /* Cinza médio escuro */
            --text-primary: #FFFFFF;      /* Branco para texto principal */
            --text-secondary: #4a90e2;    /* Azul mais claro para títulos */
            --text-tertiary: #CCCCCC;     /* Cinza claro para texto secundário */
            --border-primary: #404040;    /* Cinza escuro para bordas */
            --border-secondary: #555555;  /* Cinza médio para bordas */
        }
        
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: linear-gradient(135deg, var(--bg-secondary) 0%, var(--primary-50) 100%);
            color: var(--text-primary);
            line-height: 1.6;
            font-weight: 400;
            letter-spacing: -0.01em;
            transition: background-color 0.3s ease, color 0.3s ease;
        }
        
        /* Theme Toggle Button */
        .theme-toggle {
            position: fixed;
            top: 1rem;
            right: 1rem;
            z-index: 1000;
            background: var(--bg-primary);
            border: 2px solid var(--border-primary);
            border-radius: 50%;
            width: 3rem;
            height: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-lg);
            backdrop-filter: blur(10px);
        }
        
        .theme-toggle:hover {
            transform: scale(1.1);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-500);
        }
        
        .theme-toggle svg {
            width: 1.25rem;
            height: 1.25rem;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        
        .theme-toggle .sun-icon {
            display: block;
        }
        
        .theme-toggle .moon-icon {
            display: none;
        }
        
        [data-theme="dark"] .theme-toggle .sun-icon {
            display: none;
        }
        
        [data-theme="dark"] .theme-toggle .moon-icon {
            display: block;
        }
        
        /* Global Theme Transitions */
        *, *::before, *::after {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease, box-shadow 0.3s ease;
        }
        
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            height: 60vh;
            max-height: 550px;
            background: var(--bg-primary);
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--border-primary);
        }
        
        .comparison-chart-container {
            position: relative;
            width: 100%;
            max-width: 800px;
            margin: 0 auto;
            height: 40vh;
            max-height: 350px;
            background: var(--bg-primary);
            border-radius: var(--radius-lg);
            padding: 1.5rem;
            box-shadow: var(--shadow-md);
            border: 1px solid var(--border-primary);
        }
        
        .nav-item {
            cursor: pointer;
            padding: 0.875rem 1.25rem;
            border-radius: var(--radius-md);
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            font-size: 0.875rem;
            letter-spacing: -0.01em;
            border: 1px solid transparent;
            margin-bottom: 0.25rem;
        }
        
        .nav-item:hover {
            background: linear-gradient(135deg, var(--primary-50) 0%, var(--primary-100) 100%);
            color: var(--primary-700);
            border-color: var(--primary-200);
            transform: translateX(4px);
        }
        
        .nav-item.active {
            background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-600) 100%);
            color: white;
            box-shadow: var(--shadow-md);
            transform: translateX(4px);
        }
        
        .kpi-card {
            background: white;
            border-radius: var(--radius-xl);
            padding: 2rem;
            box-shadow: var(--shadow-lg);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            border: 1px solid var(--neutral-200);
            position: relative;
            overflow: hidden;
        }
        
        .kpi-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-400) 0%, var(--primary-600) 100%);
        }
        
        .kpi-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-xl);
            border-color: var(--primary-200);
        }
        
        .table-responsive {
            overflow-x: auto;
            border-radius: var(--radius-lg);
            box-shadow: var(--shadow-md);
            border: 1px solid var(--neutral-200);
        }
        
        .filter-btn {
            transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
            font-weight: 500;
            letter-spacing: -0.01em;
            border: 2px solid transparent;
        }
        
        .filter-btn.active {
            transform: scale(1.05);
            box-shadow: 0 0 0 3px var(--primary-100), var(--shadow-md);
            border-color: var(--primary-300);
        }
        
        .filter-btn:hover:not(.active) {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
        }
        
        /* Enhanced Typography */
        h1, h2, h3, h4, h5, h6 {
            font-weight: 700;
            letter-spacing: -0.025em;
            line-height: 1.2;
        }
        
        .text-gradient {
            background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-800) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        /* Status Indicators */
        .status-added {
            background: linear-gradient(135deg, var(--success-50) 0%, var(--success-100) 100%);
            color: var(--success-600);
            border: 1px solid var(--success-200);
            transition: all 0.3s ease;
        }
        
        .status-removed {
            background: linear-gradient(135deg, var(--error-50) 0%, var(--error-100) 100%);
            color: var(--error-600);
            border: 1px solid var(--error-200);
            transition: all 0.3s ease;
        }
        
        .status-maintained {
            background: linear-gradient(135deg, var(--neutral-50) 0%, var(--neutral-100) 100%);
            color: var(--neutral-600);
            border: 1px solid var(--neutral-200);
            transition: all 0.3s ease;
        }
        
        /* Enhanced Animations */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        .animate-fade-in-up {
            animation: fadeInUp 0.6s ease-out;
        }
        
        /* Improved Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: var(--neutral-100);
            border-radius: var(--radius-sm);
        }
        
        ::-webkit-scrollbar-thumb {
            background: linear-gradient(135deg, var(--primary-400) 0%, var(--primary-600) 100%);
            border-radius: var(--radius-sm);
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: linear-gradient(135deg, var(--primary-500) 0%, var(--primary-700) 100%);
        }
        
        /* Sidebar Toggle Styles */
        .sidebar-collapsed {
            transform: translateX(-100%) !important;
        }
        
        .main-expanded {
            margin-left: 0 !important;
        }
        
        .sidebar-toggle-btn {
            position: fixed;
            top: 1.5rem;
            left: 1.5rem;
            z-index: 50;
            background: white;
            padding: 0.75rem;
            border-radius: var(--radius-xl);
            box-shadow: var(--shadow-lg);
            border: 1px solid var(--neutral-200);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }
        
        .sidebar-toggle-btn:hover {
            box-shadow: var(--shadow-xl);
            transform: scale(1.05);
            background: linear-gradient(135deg, var(--primary-50) 0%, var(--primary-100) 100%);
        }
        
        .sidebar-toggle-btn.collapsed {
            left: 1.5rem;
        }
        
        .sidebar-toggle-btn.expanded {
            left: 19.5rem;
        }
        
        @media (max-width: 768px) {
            .sidebar-toggle-btn {
                left: 1.5rem !important;
            }
        }
        
        /* Fixed Header Styles */
        .fixed-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            z-index: 40;
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            background: rgba(255, 255, 255, 0.95);
            border-bottom: 1px solid var(--border-primary);
            box-shadow: var(--shadow-sm);
            transition: all 0.3s ease;
        }
        
        /* Theme Toggle Button in Header */
        .theme-toggle-header {
            background: var(--bg-primary);
            border: 2px solid var(--border-primary);
            border-radius: 50%;
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
        }
        
        .theme-toggle-header:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-500);
        }
        
        .theme-toggle-header svg {
            width: 1.125rem;
            height: 1.125rem;
            color: var(--text-primary);
            transition: all 0.3s ease;
        }
        
        .theme-toggle-header .sun-icon {
            display: block;
        }
        
        .theme-toggle-header .moon-icon {
            display: none;
        }
        
        [data-theme="dark"] .theme-toggle-header .sun-icon {
            display: none;
        }
        
        [data-theme="dark"] .theme-toggle-header .moon-icon {
            display: block;
        }
        
        /* Hide original theme toggle */
        .theme-toggle {
            display: none;
        }
        
        [data-theme="dark"] .fixed-header {
            background: rgba(26, 26, 26, 0.95);
        }
        
        .fixed-header-content {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.75rem 1.5rem;
            max-width: 100%;
            margin: 0 auto;
        }
        
        .fixed-header-left {
            display: flex;
            align-items: center;
            gap: 1rem;
        }
        
        .fixed-header-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        /* Sidebar Toggle Button in Header */
        .sidebar-toggle-header {
            background: var(--bg-primary);
            border: 2px solid var(--border-primary);
            border-radius: 0.5rem;
            width: 2.5rem;
            height: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
        }
        
        .sidebar-toggle-header:hover {
            transform: scale(1.05);
            box-shadow: var(--shadow-md);
            border-color: var(--primary-500);
            background: linear-gradient(135deg, var(--primary-50) 0%, var(--primary-100) 100%);
        }
        
        .sidebar-toggle-header svg {
            color: var(--text-secondary);
            transition: all 0.3s ease;
        }
        
        .sidebar-toggle-header:hover svg {
            color: var(--primary-600);
        }
        
        /* Hide original sidebar toggle */
        .sidebar-toggle-btn {
            display: none;
        }
        
        .fixed-header-icon {
            width: 2.5rem;
            height: 2.5rem;
            border-radius: 0.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            background: linear-gradient(to bottom right, var(--primary-500), var(--primary-600));
            box-shadow: var(--shadow-sm);
        }
        
        .fixed-header-title {
            font-size: 1.25rem;
            font-weight: 700;
            background: linear-gradient(135deg, var(--primary-600) 0%, var(--primary-500) 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .fixed-header-subtitle {
            font-size: 0.875rem;
            font-weight: 500;
            color: var(--text-tertiary);
        }
        
        .fixed-header-actions {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }
        
        /* Adjust main content padding to account for fixed header */
        .main-content-with-fixed-header {
            padding-top: 5rem;
        }
        
        /* Hide original header when fixed header is active */
        .original-header-hidden {
            display: none;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .fixed-header-content {
                padding: 0.5rem 1rem;
            }
            
            .fixed-header-title {
                font-size: 1rem;
            }
            
            .fixed-header-subtitle {
                display: none;
            }
            
            .main-content-with-fixed-header {
                padding-top: 4rem;
            }
            
            .theme-toggle-header {
                width: 2.25rem;
                height: 2.25rem;
            }
            
            .theme-toggle-header svg {
                width: 1rem;
                height: 1rem;
            }
        }
        
        @media (max-width: 480px) {
            .fixed-header-title {
                font-size: 0.875rem;
            }
            
            .fixed-header-icon {
                width: 2rem;
                height: 2rem;
            }
            
            .fixed-header-actions {
                gap: 0.25rem;
            }
            
            .fixed-header-actions > div:first-child {
                display: none; /* Hide 2024 → 2025 badge on very small screens */
            }
            
            .theme-toggle-header {
                width: 2rem;
                height: 2rem;
            }
            
            .theme-toggle-header svg {
                width: 0.875rem;
                height: 0.875rem;
            }
        }
    </style>
</head>
<body>
    <!-- Fixed Header -->
    <header class="fixed-header" id="fixed-header">
        <div class="fixed-header-content">
            <div class="fixed-header-left">
                <!-- Sidebar Toggle Button in Header -->
                <button id="sidebar-toggle-header" class="sidebar-toggle-header" aria-label="Alternar sidebar">
                    <svg id="sidebar-toggle-icon-header" xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
                    </svg>
                </button>
                <div class="fixed-header-logo">
                    <div class="fixed-header-icon">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                        </svg>
                    </div>
                    <div>
                        <div class="fixed-header-title">Evolução do Portfólio de Processos</div>
                        <div class="fixed-header-subtitle">Análise Estratégica Sesi/Senai</div>
                    </div>
                </div>
            </div>
            <div class="fixed-header-actions">
                <div class="inline-flex items-center px-3 py-1 rounded-full border text-xs font-semibold mr-3" style="background: linear-gradient(to right, var(--primary-50), var(--primary-100)); border-color: var(--primary-200); color: var(--primary-700);">
                    2024 ➔ 2025
                </div>
                <!-- Theme Toggle Button in Header -->
                <button id="theme-toggle-header" class="theme-toggle-header" aria-label="Alternar tema">
                    <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                    </svg>
                    <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                    </svg>
                </button>
            </div>
        </div>
    </header>

    <!-- Sidebar Toggle Button -->
    <button id="sidebar-toggle" class="sidebar-toggle-btn expanded">
        <svg id="sidebar-toggle-icon" xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="color: var(--text-secondary);">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M11 19l-7-7 7-7m8 14l-7-7 7-7" />
        </svg>
    </button>

    <div class="flex min-h-screen">
        <aside id="sidebar" class="w-72 p-6 space-y-2 fixed top-0 left-0 h-full transform transition-all duration-500 ease-in-out z-30 animate-fade-in-up" style="background: var(--bg-primary); box-shadow: var(--shadow-xl); border-right: 1px solid var(--border-primary);">
            <div class="mb-6">
                <div class="flex items-center justify-between">
                    <div>
                        <h2 class="text-xl font-bold text-gradient mb-2">Navegação</h2>
                        <div class="w-12 h-1 rounded-full" style="background: linear-gradient(to right, var(--primary-500), var(--primary-600));"></div>
                    </div>
                </div>
            </div>
            <nav id="navigation" class="space-y-1 h-[calc(100%-6rem)] overflow-y-auto pr-2"></nav>
        </aside>

        <main id="main-content" class="flex-1 ml-72 p-6 sm:p-8 lg:p-10 transition-all duration-500 ease-in-out main-content-with-fixed-header">
            <div id="overlay" class="fixed inset-0 bg-black opacity-50 z-20 hidden"></div>
            
            <!-- Theme Toggle Button -->
            <button id="theme-toggle" class="theme-toggle" aria-label="Alternar tema">
                <svg class="sun-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 3v1m0 16v1m9-9h-1M4 12H3m15.364 6.364l-.707-.707M6.343 6.343l-.707-.707m12.728 0l-.707.707M6.343 17.657l-.707.707M16 12a4 4 0 11-8 0 4 4 0 018 0z" />
                </svg>
                <svg class="moon-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" />
                </svg>
            </button>
            
            <header class="mb-12 text-center animate-fade-in-up original-header-hidden">
                <div class="inline-flex items-center justify-center w-20 h-20 rounded-2xl mb-6 shadow-lg" style="background: linear-gradient(to bottom right, var(--primary-500), var(--primary-600));">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-10 w-10 text-white" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z" />
                    </svg>
                </div>
                <h1 class="text-5xl font-extrabold text-gradient mb-4 tracking-tight">Evolução do Portfólio de Processos</h1>
                <p class="text-xl font-medium mb-2" style="color: var(--primary-600);">Análise Estratégica Sesi/Senai</p>
                <div class="inline-flex items-center px-4 py-2 rounded-full border" style="background: linear-gradient(to right, var(--primary-50), var(--primary-100)); border-color: var(--primary-200);">
                    <span class="text-sm font-semibold" style="color: var(--primary-700);">2024 ➔ 2025</span>
                </div>
            </header>

            <section id="dashboard-view" class="animate-fade-in-up">
                <div class="p-8 rounded-2xl shadow-lg mb-10 border" style="background: var(--bg-primary); border-color: var(--border-primary);">
                    <div class="flex items-center mb-6">
                        <div class="w-2 h-8 rounded-full mr-4" style="background: linear-gradient(to bottom, var(--primary-500), var(--primary-600));"></div>
                        <h2 class="text-2xl font-bold text-gradient">Comparativo Quantitativo do Portfólio</h2>
                    </div>
                    <p class="mb-8 text-lg" style="color: var(--text-tertiary);">Análise comparativa entre os portfólios 2024 e 2025</p>
                    <div id="comparison-kpis" class="grid grid-cols-1 md:grid-cols-3 gap-8">
                    </div>
                </div>
                
                 <div class="p-8 rounded-2xl shadow-lg mb-10 border" style="background: var(--bg-primary); border-color: var(--border-primary);">
                    <div class="flex items-center mb-6">
                        <div class="w-2 h-8 bg-gradient-to-b from-emerald-400 to-emerald-600 rounded-full mr-4"></div>
                        <h2 class="text-2xl font-bold text-gradient">Crescimento do Portfólio</h2>
                    </div>
                    <div class="comparison-chart-container">
                        <canvas id="comparison-chart"></canvas>
                    </div>
                </div>

                <div class="p-8 rounded-2xl shadow-lg mb-10 border" style="background: var(--bg-primary); border-color: var(--border-primary);">
                    <div class="flex items-center mb-6">
                        <div class="w-2 h-8 bg-gradient-to-b from-amber-400 to-amber-600 rounded-full mr-4"></div>
                        <h2 class="text-2xl font-bold text-gradient">Balanço da Transformação</h2>
                    </div>
                    <p class="mb-8 text-lg" style="color: var(--text-secondary);">Análise comparativa 2024 → 2025</p>
                    <div id="change-summary" class="grid grid-cols-1 md:grid-cols-2 gap-8">
                    </div>
                     <div class="mt-8 pt-6 border-t" style="border-color: var(--border-primary);">
                        <div class="flex items-start space-x-3">
                            <div class="flex-shrink-0 w-5 h-5 bg-blue-100 rounded-full flex items-center justify-center mt-0.5">
                                <svg xmlns="http://www.w3.org/2000/svg" class="h-3 w-3 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                                </svg>
                            </div>
                            <p class="text-sm leading-relaxed" style="color: var(--text-secondary);">
                <strong class="font-semibold" style="color: var(--text-primary);">Fonte dos Dados:</strong> Os números são calculados a partir da comparação ("De-Para") entre as estruturas do portfólio de 2024 e 2025, refletindo o total de itens mantidos, adicionados ou excluídos.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="p-8 rounded-2xl shadow-lg border" style="background: var(--bg-primary); border-color: var(--border-primary);">
                    <div class="flex items-center mb-6">
                        <div class="w-2 h-8 bg-gradient-to-b from-purple-400 to-purple-600 rounded-full mr-4"></div>
                        <h2 class="text-2xl font-bold text-gradient">Composição do Portfólio por Macroprocesso</h2>
                    </div>
                    <p class="mb-8 text-lg" style="color: var(--text-secondary);">Análise completa da estrutura de 2025 comparada a 2024. <span class="font-semibold text-primary-600">Clique em uma barra para detalhes.</span></p>
                    <div class="chart-container">
                        <canvas id="summary-chart"></canvas>
                    </div>
                </div>
            </section>

            <section id="detail-view" class="hidden mt-10 animate-fade-in-up">
                 <button id="back-to-dashboard" class="mb-6 inline-flex items-center px-4 py-2 border rounded-xl font-semibold transition-all duration-300 group shadow-sm" style="background: var(--bg-primary); border-color: var(--border-primary); color: var(--primary-600);" onmouseover="this.style.background='var(--primary-50)'; this.style.borderColor='var(--primary-300)';" onmouseout="this.style.background='var(--bg-primary)'; this.style.borderColor='var(--border-primary)';">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 transition-transform group-hover:-translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                    Voltar à Visão Geral
                 </button>
                <div class="p-8 rounded-2xl shadow-lg border" style="background: var(--bg-primary); border-color: var(--border-primary);">
                    <div class="mb-8">
                        <h2 id="detail-title" class="text-3xl font-bold text-gradient mb-4"></h2>
                        <div id="detail-summary" class="bg-gradient-to-r from-primary-50 to-primary-100 border-l-4 border-primary-400 p-6 rounded-r-xl">
                            <p class="text-primary-800 font-medium italic leading-relaxed"></p>
                        </div>
                    </div>
                    
                    <div class="mb-8">
                        <div class="flex items-center mb-4">
                            <div class="w-2 h-6 bg-gradient-to-b from-indigo-400 to-indigo-600 rounded-full mr-3"></div>
                            <span class="font-semibold text-lg" style="color: var(--text-primary);">Filtrar por Status</span>
                        </div>
                        <div class="flex flex-wrap gap-3">
                            <button data-filter="all" class="filter-btn active bg-gradient-to-r from-primary-500 to-primary-600 text-white px-6 py-2 rounded-full text-sm font-semibold shadow-md">Todos</button>
                            <button data-filter="Mantido" class="filter-btn px-6 py-2 rounded-full text-sm font-semibold border transition-all duration-300" style="background: var(--bg-tertiary); color: var(--text-secondary); border-color: var(--border-primary);">Mantidos</button>
                <button data-filter="Adicionado" class="filter-btn px-6 py-2 rounded-full text-sm font-semibold border transition-all duration-300" style="background: var(--bg-tertiary); color: var(--text-secondary); border-color: var(--border-primary);">Adicionados</button>
                <button data-filter="Removido" class="filter-btn px-6 py-2 rounded-full text-sm font-semibold border transition-all duration-300" style="background: var(--bg-tertiary); color: var(--text-secondary); border-color: var(--border-primary);">Removidos</button>
                        </div>
                    </div>

                    <div class="table-responsive rounded-xl border overflow-hidden shadow-sm" style="background: var(--bg-primary); border-color: var(--border-primary);">
                         <table class="min-w-full">
                            <thead style="background: linear-gradient(to right, var(--bg-secondary), var(--bg-tertiary));">
                                <tr>
                                    <th scope="col" class="px-8 py-4 text-left text-sm font-bold uppercase tracking-wide border-b" style="color: var(--text-secondary); border-color: var(--border-primary);">Status</th>
                                    <th scope="col" class="px-8 py-4 text-left text-sm font-bold uppercase tracking-wide border-b" style="color: var(--text-secondary); border-color: var(--border-primary);">Processo</th>
                                    <th scope="col" class="px-8 py-4 text-left text-sm font-bold uppercase tracking-wide border-b" style="color: var(--text-secondary); border-color: var(--border-primary);">Subprocesso</th>
                                </tr>
                            </thead>
                            <tbody id="detail-table-body" style="border-color: var(--border-secondary);">
                            </tbody>
                        </table>
                    </div>
                </div>
            </section>
            
            <section id="list-view" class="hidden mt-10 animate-fade-in-up">
                <button id="back-to-dashboard-from-list" class="mb-6 inline-flex items-center px-4 py-2 border rounded-xl font-semibold transition-all duration-200 group shadow-sm" style="background: var(--bg-primary); border-color: var(--border-primary); color: var(--primary-600);" onmouseover="this.style.background='var(--primary-50)'; this.style.borderColor='var(--primary-300)';" onmouseout="this.style.background='var(--bg-primary)'; this.style.borderColor='var(--border-primary)';">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 transition-transform group-hover:-translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                    Voltar à Visão Geral
                 </button>
                 <div class="p-8 rounded-2xl shadow-lg border" style="background: var(--bg-primary); border-color: var(--border-primary);">
                    <div class="flex flex-wrap items-start justify-between mb-8 gap-6">
                        <div>
                             <h2 class="text-3xl font-bold text-gradient mb-4">Listagem Completa do Portfólio</h2>
                             <div class="flex items-center mb-4">
                                <div class="w-2 h-6 bg-gradient-to-b from-emerald-400 to-emerald-600 rounded-full mr-3"></div>
                                <span class="font-semibold text-lg" style="color: var(--text-primary);">Opções de Exportação</span>
                             </div>
                             <div class="flex items-center flex-wrap gap-3">
                                <button id="export-list-sheets" class="inline-flex items-center gap-2 px-4 py-2 bg-emerald-50 hover:bg-emerald-100 text-emerald-700 font-semibold rounded-xl border border-emerald-200 transition-all duration-200 shadow-sm">
                                    <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect width="18" height="18" x="3" y="3" rx="2"></rect><path d="M3 9h18"></path><path d="M3 15h18"></path><path d="M9 3v18"></path><path d="M15 3v18"></path></svg>
                                    Google Sheets
                                </button>
                                <button id="export-list-pdf" class="inline-flex items-center gap-2 px-4 py-2 bg-red-50 hover:bg-red-100 text-red-700 font-semibold rounded-xl border border-red-200 transition-all duration-200 shadow-sm">
                                    <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="M10 12v6"></path><path d="M14 18h-4"></path><path d="M10 15h2a2 2 0 1 0 0-3h-2v3Z"></path></svg>
                                    PDF
                                </button>
                                <button id="export-list-docs" class="inline-flex items-center gap-2 px-4 py-2 bg-blue-50 hover:bg-blue-100 text-blue-700 font-semibold rounded-xl border border-blue-200 transition-all duration-200 shadow-sm">
                                    <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="M10 13H8"></path><path d="M16 13H8"></path><path d="M16 17H8"></path><path d="M10 17H8"></path></svg>
                                    Google Docs
                                </button>
                            </div>
                        </div>
                         <div id="list-view-filters" class="">
                            <div class="flex items-center mb-4">
                                <div class="w-2 h-6 bg-gradient-to-b from-purple-400 to-purple-600 rounded-full mr-3"></div>
                                <span class="font-semibold text-lg" style="color: var(--text-primary);">Filtrar por Status</span>
                            </div>
                            <div class="flex flex-wrap gap-3">
                                <button data-filter="all" class="filter-btn active bg-gradient-to-r from-primary-500 to-primary-600 text-white px-6 py-2 rounded-full text-sm font-semibold shadow-md">Todos</button>
                                <button data-filter="Mantido" class="filter-btn px-6 py-2 rounded-full text-sm font-semibold border transition-all duration-300" style="background: var(--bg-tertiary); color: var(--text-secondary); border-color: var(--border-primary);">Mantidos</button>
                                <button data-filter="Adicionado" class="filter-btn px-6 py-2 rounded-full text-sm font-semibold border transition-all duration-300" style="background: var(--bg-tertiary); color: var(--text-secondary); border-color: var(--border-primary);">Adicionados</button>
                                <button data-filter="Removido" class="filter-btn px-6 py-2 rounded-full text-sm font-semibold border transition-all duration-300" style="background: var(--bg-tertiary); color: var(--text-secondary); border-color: var(--border-primary);">Excluídos</button>
                            </div>
                        </div>
                    </div>
                    <div id="full-list-container" class="space-y-4"></div>
                 </div>
            </section>

            <section id="history-view" class="hidden mt-10 animate-fade-in-up">
                <button id="back-to-dashboard-from-history" class="mb-6 inline-flex items-center px-4 py-2 border rounded-xl font-semibold transition-all duration-200 group shadow-sm" style="background: var(--bg-primary); border-color: var(--border-primary); color: var(--primary-600);" onmouseover="this.style.background='var(--primary-50)'; this.style.borderColor='var(--primary-300)';" onmouseout="this.style.background='var(--bg-primary)'; this.style.borderColor='var(--border-primary)';">
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 transition-transform group-hover:-translate-x-1" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18" /></svg>
                    Voltar à Visão Geral
                </button>
                <div class="p-8 rounded-2xl shadow-lg border" style="background: var(--bg-primary); border-color: var(--border-primary);">
                    <div class="flex flex-wrap items-center justify-between mb-8 pb-6 border-b gap-6" style="border-color: var(--border-primary);">
                        <div>
                            <h2 class="text-3xl font-bold text-gradient mb-4">Histórico de Mudanças Recentes</h2>
                            <div class="flex items-center mb-4">
                                <div class="w-2 h-6 bg-gradient-to-b from-amber-400 to-amber-600 rounded-full mr-3"></div>
                                <span class="font-semibold text-lg" style="color: var(--text-primary);">Opções de Exportação</span>
                            </div>
                        </div>
                         <div class="flex items-center flex-wrap gap-3">
                            <button id="export-history-pdf" class="inline-flex items-center gap-2 px-4 py-2 font-semibold rounded-xl border transition-all duration-200 shadow-sm" style="background: var(--error-50); color: var(--error-700); border-color: var(--error-200);" onmouseover="this.style.background='var(--error-100)';" onmouseout="this.style.background='var(--error-50)';">
                               <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="M10 12v6"></path><path d="M14 18h-4"></path><path d="M10 15h2a2 2 0 1 0 0-3h-2v3Z"></path></svg>
                                PDF
                            </button>
                            <button id="export-history-docs" class="inline-flex items-center gap-2 px-4 py-2 font-semibold rounded-xl border transition-all duration-200 shadow-sm" style="background: var(--info-50); color: var(--info-700); border-color: var(--info-200);" onmouseover="this.style.background='var(--info-100)';" onmouseout="this.style.background='var(--info-50)';">
                               <svg class="w-4 h-4" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path><polyline points="14 2 14 8 20 8"></polyline><path d="M10 13H8"></path><path d="M16 13H8"></path><path d="M16 17H8"></path><path d="M10 17H8"></path></svg>
                                Google Docs
                            </button>
                        </div>
                    </div>

                    <div id="history-content" class="space-y-8">
                        <div class="p-6 border rounded-2xl shadow-sm" style="background: var(--bg-secondary); border-color: var(--info-200);">
                            <div class="flex items-center mb-4">
                                <div class="w-3 h-8 rounded-full mr-4" style="background: linear-gradient(to bottom, var(--info-400), var(--info-600));"></div>
                                <h3 class="text-xl font-bold" style="color: var(--info-700);">Relacionamento com o Cliente de Educação Profissional</h3>
                            </div>
                            <div class="space-y-6">
                                <div class="p-5 rounded-xl border" style="background: var(--bg-primary); border-color: var(--info-200);">
                                    <h4 class="font-bold mb-3" style="color: var(--text-primary);">Processo: Gerenciar Oferta dos Serviços de Educação Profissional</h4>
                                    <div class="flex items-start gap-3">
                                        <div class="w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5" style="background: var(--warning-100);">
                                            <span class="text-sm font-bold" style="color: var(--warning-600);">🔄</span>
                                        </div>
                                        <p class="leading-relaxed" style="color: var(--text-secondary);"><span class="font-semibold" style="color: var(--warning-700);">Simplificação:</span> Os subprocessos "Realizar Oferta de Serviços de Educação Profissional para Pessoa Física", "Realizar Oferta de Serviços de Educação Profissional para Pessoa Jurídica" e "Realizar Gestão da Oferta de Serviços da Aprendizagem Industrial" foram unificados em um único subprocesso: <strong style="color: var(--info-700);">"Realizar Gestão da Oferta de Serviços de Educação Profissional"</strong>.</p>
                                    </div>
                                </div>
                                <div class="p-5 rounded-xl border" style="background: var(--bg-primary); border-color: var(--info-200);">
                                    <h4 class="font-bold mb-3" style="color: var(--text-primary);">Processo: Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Profissional</h4>
                                    <div class="space-y-4">
                                        <div class="flex items-start gap-3">
                                            <div class="w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5" style="background: var(--purple-100);">
                                                <span class="text-sm font-bold" style="color: var(--purple-600);">✍️</span>
                                            </div>
                                            <p class="leading-relaxed" style="color: var(--text-secondary);"><span class="font-semibold" style="color: var(--purple-700);">Renomeado:</span> O subprocesso "Realizar Serviço de Aprendizagem Industrial" foi renomeado para <strong style="color: var(--info-700);">"Administrar o Relacionamento de Aprendizagem Industrial"</strong>.</p>
                                        </div>
                                        <div class="flex items-start gap-3">
                                            <div class="w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5" style="background: var(--success-100);">
                                                <span class="text-sm font-bold" style="color: var(--success-600);">✨</span>
                                            </div>
                                            <p class="leading-relaxed" style="color: var(--text-secondary);"><span class="font-semibold" style="color: var(--success-700);">Novo:</span> Um novo subprocesso, <strong style="color: var(--info-700);">"Realizar Serviços de Educação Profissional"</strong>, foi criado durante o mapeamento.</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="p-6 border rounded-2xl shadow-sm" style="background: var(--bg-secondary); border-color: var(--purple-200);">
                            <div class="flex items-center mb-4">
                                <div class="w-3 h-8 rounded-full mr-4" style="background: linear-gradient(to bottom, var(--purple-400), var(--purple-600));"></div>
                                <h3 class="text-xl font-bold" style="color: var(--purple-700);">Tecnologia da Informação</h3>
                            </div>
                            <div class="p-5 rounded-xl border" style="background: var(--bg-primary); border-color: var(--info-200);">
                                <h4 class="font-bold mb-3" style="color: var(--text-primary);">Processo: Gerenciar Prospecção e Desenvolvimento de Soluções de TI</h4>
                                <div class="flex items-start gap-3">
                                    <div class="w-6 h-6 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5" style="background: var(--indigo-100);">
                                        <span class="text-sm font-bold" style="color: var(--indigo-600);">🔀</span>
                                    </div>
                                    <p class="leading-relaxed" style="color: var(--text-secondary);"><span class="font-semibold" style="color: var(--indigo-700);">Desmembrado:</span> O subprocesso "Administrar Suporte da Operação de TI (Desenvolvimento)" foi estratificado em dois novos subprocessos: <strong style="color: var(--purple-700);">"Administrar Melhorias de Sistemas"</strong> e <strong style="color: var(--purple-700);">"Gerenciar o Tratamento de Bugs de Sistemas"</strong>.</p>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>
            </section>

        </main>
    </div>

    <!-- Export Modal -->
    <div id="export-modal" class="fixed inset-0 bg-black bg-opacity-60 z-50 hidden items-center justify-center p-4 transition-opacity duration-300">
        <div class="rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] flex flex-col transform transition-transform duration-300 scale-95" style="background: var(--bg-primary);">
            <div class="p-4 border-b flex justify-between items-center rounded-t-lg" style="background: var(--bg-secondary); border-color: var(--border-primary);">
                <h3 id="modal-title" class="text-lg font-bold" style="color: var(--text-primary);">Exportar Dados</h3>
                <button id="modal-close-btn" class="text-2xl font-light transition-colors" style="color: var(--text-tertiary);" onmouseover="this.style.color='var(--text-primary)';" onmouseout="this.style.color='var(--text-tertiary)';">&times;</button>
            </div>
            <div class="p-6 overflow-y-auto">
                <div id="modal-filter-area" class="hidden mb-5">
                    <div class="font-medium text-sm mb-2" style="color: var(--text-secondary);">Filtrar por Status:</div>
                    <div id="modal-filters" class="flex items-center space-x-2 flex-wrap gap-y-2">
                        <!-- Filter buttons will be injected here by JS -->
                    </div>
                </div>
                <p class="text-sm mb-3 font-semibold" style="color: var(--text-secondary);">Instruções:</p>
                <ol class="list-decimal list-inside text-sm mb-5 space-y-1.5 p-3 rounded-md border" style="color: var(--text-tertiary); background: var(--bg-tertiary); border-color: var(--border-primary);">
                    <li>Selecione um filtro acima para refinar os dados (opcional).</li>
                    <li>Clique no botão <strong style="color: var(--primary-600);">"Copiar..."</strong> para copiar os dados.</li>
                    <li>Em seguida, clique no botão <strong class="text-blue-600">"Abrir..."</strong> para ir ao Google Docs/Sheets.</li>
                    <li>Cole o conteúdo copiado no novo documento (usando Ctrl+V ou Cmd+V).</li>
                </ol>
                <div id="modal-content-area" class="border rounded-md" style="background: var(--bg-primary); border-color: var(--border-primary);">
                    <!-- Content will be injected here -->
                </div>
            </div>
            <div class="p-4 border-t rounded-b-lg flex flex-wrap justify-end items-center gap-3" style="background: var(--bg-secondary); border-color: var(--border-primary);">
                <button id="modal-copy-btn" class="text-white font-bold py-2 px-4 rounded-lg transition-all duration-200 ease-in-out flex items-center gap-2 shadow-sm hover:shadow-md" style="background: var(--primary-500);" onmouseover="this.style.background='var(--primary-600)'" onmouseout="this.style.background='var(--primary-500)'">
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    Copiar para a Área de Transferência
                </button>
                <a id="modal-link-btn" href="#" target="_blank" class="bg-blue-500 text-white font-bold py-2 px-4 rounded-lg hover:bg-blue-600 transition-all duration-200 ease-in-out shadow-sm hover:shadow-md">Abrir...</a>
            </div>
        </div>
    </div>


    <script>
        const reportData = {
            "Governança Corporativa": {
                summary: "A expansão da Governança Corporativa é o destaque estratégico de 2025. A formalização de processos de Compliance, Riscos, Crises e Gestão de Documentos sinaliza um forte amadurecimento da gestão, essencial para mitigar riscos, garantir conformidade e aumentar a resiliência organizacional.",
                changes: [
                    { status: 'Mantido', process: 'Gerenciar Manifestações de Clientes Internos', subprocess: 'Administrar Denúncias' },
                    { status: 'Mantido', process: 'Gerenciar Manifestações de Clientes Internos', subprocess: 'Administrar Ouvidoria' },
                    { status: 'Adicionado', process: 'Gerenciar Compliance', subprocess: 'Fomentar Ética' },
                    { status: 'Adicionado', process: 'Gerenciar Compliance', subprocess: 'Fomentar LGPD' },
                    { status: 'Adicionado', process: 'Gerenciar Compliance', subprocess: 'Fomentar Transparência e Realizar Prestação de Contas' },
                    { status: 'Adicionado', process: 'Gerenciar Compliance', subprocess: 'Realizar Auditoria e Controles Internos' },
                    { status: 'Adicionado', process: 'Gerenciar Crises', subprocess: 'Administrar Crise' },
                    { status: 'Adicionado', process: 'Gerenciar Informações Documentadas', subprocess: 'Administrar Documentos Externos' },
                    { status: 'Adicionado', process: 'Gerenciar Informações Documentadas', subprocess: 'Administrar Documentos Normativos' },
                    { status: 'Adicionado', process: 'Gerenciar Informações Documentadas', subprocess: 'Administrar Documentos Operacionais' },
                    { status: 'Adicionado', process: 'Gerenciar Riscos', subprocess: 'Realizar Mapeamento e Monitoramento dos Riscos de Projetos' },
                    { status: 'Adicionado', process: 'Gerenciar Riscos', subprocess: 'Realizar Mapeamento e Monitoramento dos Riscos Estratégicos' },
                    { status: 'Adicionado', process: 'Gerenciar Riscos', subprocess: 'Realizar Mapeamento e Monitoramento dos Riscos Operacionais' }
                ]
            },
            "Gestão da Estratégia": {
                summary: "A Gestão da Estratégia foi profundamente reestruturada e detalhada, passando de um planejamento geral para uma gestão executiva completa. A inclusão de processos como 'Gerenciar Produção', 'Gerenciar Processo Decisório' e 'Sistema de Medição' fortalece a conexão entre o plano e a operação, garantindo maior controle sobre a execução e os resultados.",
                changes: [
                    { status: 'Removido', process: 'Gerenciar Planejamento Estratégico', subprocess: 'Desdobrar Estratégia'},
                    { status: 'Removido', process: 'Gerenciar Planejamento Estratégico', subprocess: 'Formular Estratégia'},
                    { status: 'Removido', process: 'Gerenciar Portfólio de Projetos', subprocess: 'Administrar Portfólio de Projetos'},
                    { status: 'Adicionado', process: 'Gerenciar a Estratégia', subprocess: 'Administrar a Estratégia Organizacional'},
                    { status: 'Adicionado', process: 'Gerenciar Produção', subprocess: 'Administrar Produção Educação Básica'},
                    { status: 'Adicionado', process: 'Gerenciar Produção', subprocess: 'Administrar Produção Educação Profissional'},
                    { status: 'Adicionado', process: 'Gerenciar Produção', subprocess: 'Administrar Produção Inovação e Tecnologia'},
                    { status: 'Adicionado', process: 'Gerenciar Produção', subprocess: 'Administrar Produção Segurança e Saúde para Indústria'},
                    { status: 'Adicionado', process: 'Gerenciar Orçamento', subprocess: 'Administrar Orçamento'},
                    { status: 'Adicionado', process: 'Estruturar e Gerenciar Projetos', subprocess: 'Estruturar Diretrizes de Captação de Recursos e Investimentos'},
                    { status: 'Adicionado', process: 'Estruturar e Gerenciar Projetos', subprocess: 'Elaborar Pré-Projetos e Projetos'},
                    { status: 'Adicionado', process: 'Estruturar e Gerenciar Projetos', subprocess: 'Executar e Monitorar Projetos'},
                    { status: 'Adicionado', process: 'Estruturar e Gerenciar Projetos', subprocess: 'Encerrar Projetos'},
                    { status: 'Adicionado', process: 'Gerenciar Processo Decisório', subprocess: 'Realizar Reuniões Decisórias'},
                    { status: 'Adicionado', process: 'Gerenciar o Sistema de Medição', subprocess: 'Administrar Indicadores Estratégicos'},
                    { status: 'Adicionado', process: 'Gerenciar o Sistema de Medição', subprocess: 'Administrar Indicadores Táticos e Operacionais'},
                ]
            },
            "Gestão por processos": {
                summary: "A criação do macroprocesso de Gestão por Processos é um passo fundamental para a excelência operacional. A implementação de um ciclo de vida de processos (mapeamento, monitoramento, melhoria) com base em frameworks como BPM permite que a organização identifique gargalos e otimize a entrega de valor.",
                changes: [
                    { status: 'Adicionado', process: 'Gerenciar Arquitetura de Processos e Documentos', subprocess: 'Administrar Cadeia de Valor e Portfólio de Processos' },
                    { status: 'Adicionado', process: 'Gerenciar Arquitetura de Processos e Documentos', subprocess: 'Administrar Documentos' },
                    { status: 'Adicionado', process: 'Gerenciar Arquitetura de Processos e Documentos', subprocess: 'Administrar Mapeamento e Implantação de Processos' },
                    { status: 'Adicionado', process: 'Gerenciar Melhoria Contínua e o Aperfeiçoamento da Gestão', subprocess: 'Administrar Ocorrências' },
                    { status: 'Adicionado', process: 'Gerenciar Melhoria Contínua e o Aperfeiçoamento da Gestão', subprocess: 'Aperfeiçoar o Modelo de Gestão' },
                    { status: 'Adicionado', process: 'Gerenciar Melhoria Contínua e o Aperfeiçoamento da Gestão', subprocess: 'Realizar o Monitoramento dos Processos' }
                ]
            },
            "Gente e Cultura Organizacional": {
                summary: "A estrutura de Gente e Cultura foi expandida para além do transacional, incluindo agora processos estratégicos como gestão de desempenho, cultura e clima, e inovação corporativa. Isso demonstra um foco maior no desenvolvimento e engajamento dos colaboradores como pilar para o sucesso do negócio.",
                changes: [
                    { status: 'Removido', process: 'Gerenciar Administração de Pessoal', subprocess: 'Administrar Folha de Pagamento' },
                    { status: 'Removido', process: 'Gerenciar Administração de Pessoal', subprocess: 'Administrar Relações Trabalhistas e Sindicais' },
                    { status: 'Removido', process: 'Gerenciar Recrutamento e Seleção', subprocess: 'Administrar Desligamento' },
                    { status: 'Removido', process: 'Gerenciar Recrutamento e Seleção', subprocess: 'Administrar Recrutamento e Seleção' },
                    { status: 'Removido', process: 'Gerenciar Remuneração', subprocess: 'Administrar Cargos e Salários' },
                    { status: 'Removido', process: 'Gerenciar Treinamento e Desenvolvimento', subprocess: 'Realizar Levantamento das Necessidades de Treinamento' },
                    { status: 'Removido', process: 'Gerenciar Treinamento e Desenvolvimento', subprocess: 'Realizar Treinamento e Desenvolvimento' },
                    { status: 'Adicionado', process: 'Gerenciar Cargos e Salários', subprocess: 'Administrar Políticas de Cargos e Salários' },
                    { status: 'Adicionado', process: 'Gerenciar Cargos e Salários', subprocess: 'Administrar Cargos e Salários' },
                    { status: 'Adicionado', process: 'Gerenciar Cargos e Salários', subprocess: 'Administrar o Planjamento de Mão de Obra' },
                    { status: 'Adicionado', process: 'Gerenciar a Atração, Seleção e Movimentação de Talentos', subprocess: 'Administrar a Atração e Seleção de Talentos' },
                    { status: 'Adicionado', process: 'Gerenciar a Atração, Seleção e Movimentação de Talentos', subprocess: 'Administrar Onboarding de Talentos' },
                    { status: 'Adicionado', process: 'Gerenciar a Atração, Seleção e Movimentação de Talentos', subprocess: 'Administrar as Movimentações de Pessoal' },
                    { status: 'Adicionado', process: 'Gerenciar a Atração, Seleção e Movimentação de Talentos', subprocess: 'Administrar Contratos de Trabalho (Admissão e Movimentação de Pessoal)' },
                    { status: 'Adicionado', process: 'Gerenciar a Atração, Seleção e Movimentação de Talentos', subprocess: 'Administrar Desligamento de Pessoal' },
                    { status: 'Adicionado', process: 'Gerenciar as Ações de Capacitação e Desenvolvimento', subprocess: 'Planejar Ações de Capacitação e Desenvolvimento' },
                    { status: 'Adicionado', process: 'Gerenciar as Ações de Capacitação e Desenvolvimento', subprocess: 'Executar Ações de Capacitação e Desenvolvimento' },
                    { status: 'Adicionado', process: 'Gerenciar as Ações de Capacitação e Desenvolvimento', subprocess: 'Monitorar Ações de Capacitação e Desenvolvimento' },
                    { status: 'Adicionado', process: 'Gerenciar o Desempenho das Pessoas', subprocess: 'Realizar Avaliação de Desempenho das Pessoas' },
                    { status: 'Adicionado', process: 'Gerenciar a Cultura e o Clima Organizacional', subprocess: 'Administrar a Cultura Organizacional' },
                    { status: 'Adicionado', process: 'Gerenciar a Cultura e o Clima Organizacional', subprocess: 'Administrar o Clima Organizacional' },
                    { status: 'Adicionado', process: 'Gerenciar a Cultura e o Clima Organizacional', subprocess: 'Administrar Ações de Endomarketing' },
                    { status: 'Adicionado', process: 'Gerenciar a Inovação Corporativa', subprocess: 'Administrar as Ações de Intraempreendedorismo' },
                    { status: 'Adicionado', process: 'Gerenciar a Inovação Corporativa', subprocess: 'Administrar as Ações de Inovação Aberta' },
                    { status: 'Adicionado', process: 'Gerenciar a Inovação Corporativa', subprocess: 'Administrar as Inovações Implantadas' },
                ]
            },
            "Tecnologia da Informação": {
                summary: "A TI foi reestruturada para refletir uma abordagem mais moderna e orientada a serviços. A adição de 'Gerenciar Aplicações Web' como um processo distinto e a reclassificação da 'Estratégia de TI' para dentro da governança demonstram um alinhamento mais forte com as necessidades do negócio digital.",
                changes: [
                    { status: 'Removido', process: '—', subprocess: 'Administrar Estratégia de TI' },
                    { status: 'Adicionado', process: 'Gerenciar Governança, Integração e Conformidade de TI', subprocess: 'Administrar Estratégia de TI' },
                    { status: 'Mantido', process: 'Gerenciar Governança, Integração e Conformidade de TI', subprocess: 'Administrar Arquitetura de Sistemas' },
                    { status: 'Mantido', process: 'Gerenciar Governança, Integração e Conformidade de TI', subprocess: 'Administrar Auditorias e Compliance de TI' },
                    { status: 'Mantido', process: 'Gerenciar Governança, Integração e Conformidade de TI', subprocess: 'Gerir Portfólio de Serviços de TI' },
                    { status: 'Removido', process: 'Gerenciar Prospecção e Desenvolvimento de Soluções de TI', subprocess: 'Administrar Suporte da Operação de TI (Desenvolvimento)' },
                    { status: 'Adicionado', process: 'Gerenciar Prospecção e Desenvolvimento de Soluções de TI', subprocess: 'Administrar Melhorias de Sistemas' },
                    { status: 'Adicionado', process: 'Gerenciar Prospecção e Desenvolvimento de Soluções de TI', subprocess: 'Gerenciar o Tratamento de Bugs de Sistemas' },
                    { status: 'Mantido', process: 'Gerenciar Prospecção e Desenvolvimento de Soluções de TI', subprocess: 'Desenvolver Soluções de TI' },
                    { status: 'Mantido', process: 'Gerenciar Prospecção e Desenvolvimento de Soluções de TI', subprocess: 'Implantar Soluções de TI de Mercado' },
                    { status: 'Mantido', process: 'Gerenciar Prospecção e Desenvolvimento de Soluções de TI', subprocess: 'Prospectar Soluções de TI' },
                    { status: 'Mantido', process: 'Gerenciar infraestrutura de tecnologia da informação e comunicação', subprocess: 'Administrar Infraestrutura de Hardware e Software' },
                    { status: 'Mantido', process: 'Gerenciar infraestrutura de tecnologia da informação e comunicação', subprocess: 'Administrar Segurança dos Dados e Informações' },
                    { status: 'Mantido', process: 'Gerenciar infraestrutura de tecnologia da informação e comunicação', subprocess: 'Administrar Suporte da Operação de TI (Infraestrutura)' },
                    { status: 'Mantido', process: 'Gerenciar infraestrutura de tecnologia da informação e comunicação', subprocess: 'Garantir infraestrutura de Rede e Comunicação' },
                    { status: 'Adicionado', process: 'Gerenciar Aplicações Web', subprocess: 'Desenvolver Aplicações Web' },
                    { status: 'Adicionado', process: 'Gerenciar Aplicações Web', subprocess: 'Prestar Suporte e Manutenção a Aplicações Web' }
                ]
            },
            "Data Analytics": {
                summary: "O macroprocesso de Data Analytics foi significativamente expandido, evoluindo de uma função de inteligência de mercado para uma plataforma de dados completa. A inclusão de processos como 'Modelos Analíticos Avançados', 'Plataforma de Dados' e 'UX' demonstra uma alta maturidade e um investimento sério para se tornar uma organização orientada a dados.",
                changes: [
                    { status: 'Removido', process: 'Gerenciar Governança de Dados', subprocess: 'Administrar Governança de Dados'},
                    { status: 'Removido', process: 'Gerenciar Inteligência de Mercado', subprocess: 'Realizar Análise de Dados'},
                    { status: 'Removido', process: 'Gerenciar Inteligência de Mercado', subprocess: 'Realizar Coleta de Dados'},
                    { status: 'Removido', process: 'Gerenciar Inteligência de Mercado', subprocess: 'Realizar Disponibilização de Dados'},
                    { status: 'Adicionado', process: 'Gerenciar Estudos e Pesquisas Socioeconômicas, Setoriais e Territoriais', subprocess: 'Desenvolver Estudos e Pesquisas Socioeconômicas, Setoriais e Territoriais' },
                    { status: 'Adicionado', process: 'Gerenciar Inteligência de Dados e Dashboards', subprocess: 'Desenvolver Inteligência de Dados e Dashboards' },
                    { status: 'Adicionado', process: 'Gerenciar Inteligência de Dados e Dashboards', subprocess: 'Prestar Suporte e Manutenção a Inteligência de Dados e Dashboards' },
                    { status: 'Adicionado', process: 'Gerenciar Interface e Experiência do Usuário', subprocess: 'Desenvolver Interface do Usuário' },
                    { status: 'Adicionado', process: 'Gerenciar Modelos Analíticos Avançados', subprocess: 'Desenvolver Modelos Analíticos Avançados' },
                    { status: 'Adicionado', process: 'Gerenciar Plataforma de Dados', subprocess: 'Desenvolver Plataforma de Dados' },
                    { status: 'Adicionado', process: 'Gerenciar Plataforma de Dados', subprocess: 'Prestar Suporte e Manutenção a Plataforma de Dados' },
                    { status: 'Adicionado', process: 'Gerenciar Base de Empresas', subprocess: 'Cadastrar Novas Empresas na Base de Dados' },
                    { status: 'Adicionado', process: 'Gerenciar Base de Empresas', subprocess: 'Atualizar Empresas na Base de Dados' },
                    { status: 'Adicionado', process: 'Gerenciar Base de Empresas', subprocess: 'Monitorar Inclusão de Novas Empresas na Base de Dados' },
                    { status: 'Adicionado', process: 'Gerenciar Base de Empresas', subprocess: 'Sanear Empresas já Cadastradas na Base de Dados' },
                    { status: 'Adicionado', process: 'Gerenciar Prospectiva Tecnológica, Setorial e Territorial', subprocess: 'Desenvolver Estudos de Rotas Tecnológicas' },
                    { status: 'Adicionado', process: 'Gerenciar Prospectiva Tecnológica, Setorial e Territorial', subprocess: 'Desenvolver Estudos e Cenários Prospectivos' },
                    { status: 'Adicionado', process: 'Gerenciar Prospectiva Tecnológica, Setorial e Territorial', subprocess: 'Desenvolver Estudos de Perfis Profissionais do Futuro' }
                ]
            },
            "Gestão Administrativa": {
                summary: "A Gestão Administrativa foi detalhada, passando de categorias amplas para processos mais específicos e granulares, especialmente na gestão de contratos e rotinas de pessoal. Isso melhora o controle, a rastreabilidade e a eficiência das operações de back-office.",
                changes: [
                    { status: 'Removido', process: 'Gerenciar Compras', subprocess: 'Administrar Compras e Contratações' },
                    { status: 'Removido', process: 'Gerenciar Compras', subprocess: 'Administrar Fornecedores' },
                    { status: 'Removido', process: 'Gerenciar Compras', subprocess: 'Administrar Licitações' },
                    { status: 'Removido', process: 'Gerenciar Facilities', subprocess: 'Administrar Manutenção Predial e de Equipamentos' },
                    { status: 'Removido', process: 'Gerenciar Facilities', subprocess: 'Administrar Serviços Gerais' },
                    { status: 'Removido', process: 'Gerenciar Logística', subprocess: 'Administrar Almoxarifado' },
                    { status: 'Removido', process: 'Gerenciar Logística', subprocess: 'Administrar Frota' },
                    { status: 'Removido', process: 'Gerenciar Patrimônio', subprocess: 'Administrar Patrimônio' },
                    { status: 'Adicionado', process: 'Gerenciar Rotinas de Pessoal', subprocess: 'Administrar Jornada de Trabalho' },
                    { status: 'Adicionado', process: 'Gerenciar Rotinas de Pessoal', subprocess: 'Administrar Férias' },
                    { status: 'Adicionado', process: 'Gerenciar Rotinas de Pessoal', subprocess: 'Administrar Folha de Pagamento' },
                    { status: 'Adicionado', process: 'Gerenciar Suprimentos', subprocess: 'Planejar Aquisição de Consumos, Insumos Bens e Serviços' },
                    { status: 'Adicionado', process: 'Gerenciar Suprimentos', subprocess: 'Administrar Portfólio de Materiais e Serviços' },
                    { status: 'Adicionado', process: 'Gerenciar Suprimentos', subprocess: 'Administrar Cadeia de Fornecedores' },
                    { status: 'Adicionado', process: 'Gerenciar Suprimentos', subprocess: 'Administrar Aquisição de Consumos, Insumos, Bens e Serviços' },
                    { status: 'Adicionado', process: 'Gerenciar Suprimentos', subprocess: 'Administrar Estoque (Bens de Consumo e Insumo)' },
                    { status: 'Adicionado', process: 'Gerenciar Suprimentos', subprocess: 'Administrar Serviços de Viagens (Hospedagens, Passagens e Diárias/Ajuda de Custo)' },
                    { status: 'Adicionado', process: 'Gerenciar Suprimentos', subprocess: 'Administrar Processo de Contratação com Disputa' },
                    { status: 'Adicionado', process: 'Gerenciar Contratos a Pagar', subprocess: 'Administrar Fundo Fixo' },
                    { status: 'Adicionado', process: 'Gerenciar Contratos a Pagar', subprocess: 'Administrar Contratos de Suprimentos' },
                    { status: 'Adicionado', process: 'Gerenciar Contratos a Pagar', subprocess: 'Administrar Contratos de Patrocínio' },
                    { status: 'Adicionado', process: 'Gerenciar Contratos a Pagar', subprocess: 'Administrar Contratos de Doação' },
                    { status: 'Adicionado', process: 'Gerenciar Contratos a Pagar', subprocess: 'Administrar Contratos de Credenciamento de Saúde e Segurança' },
                    { status: 'Adicionado', process: 'Gerenciar Contratos a Pagar', subprocess: 'Administrar Contratos de Credenciamento de Educação e STI' },
                    { status: 'Adicionado', process: 'Gerenciar Contratos a Pagar', subprocess: 'Administrar Contratos de Convênio' },
                    { status: 'Adicionado', process: 'Gerenciar Contratos a Pagar', subprocess: 'Administrar Contratos do IEL' },
                    { status: 'Adicionado', process: 'Gerenciar Ativos', subprocess: 'Administrar Patrimônio' },
                    { status: 'Adicionado', process: 'Gerenciar Ativos', subprocess: 'Administrar Telefonia Móvel' },
                    { status: 'Adicionado', process: 'Gerenciar Transportes', subprocess: 'Realizar Manutenção de Veículos' },
                    { status: 'Adicionado', process: 'Gerenciar Transportes', subprocess: 'Administrar Frota de Veículos' },
                    { status: 'Adicionado', process: 'Gerenciar Transportes', subprocess: 'Administrar Solicitação de Transporte por Aplicativo' },
                    { status: 'Adicionado', process: 'Gerenciar Infraestrutura Predial', subprocess: 'Administrar Intervenções Estruturais' },
                    { status: 'Adicionado', process: 'Gerenciar Infraestrutura Predial', subprocess: 'Administrar Manutenção Predial Preventiva' },
                    { status: 'Adicionado', process: 'Gerenciar Infraestrutura Predial', subprocess: 'Administrar Manutenção Predial Corretiva - Emergencial' },
                    { status: 'Adicionado', process: 'Gerenciar Manutenção em Máquinas e Equipamentos', subprocess: 'Realizar Manutenção Preventiva de Máquinas e Equipamentos' },
                    { status: 'Adicionado', process: 'Gerenciar Manutenção em Máquinas e Equipamentos', subprocess: 'Realizar Manutenção Corretiva de Máquinas e Equipamentos' },
                    { status: 'Adicionado', process: 'Gerenciar Espaços para Eventos', subprocess: 'Administrar Espaços para Eventos' },
                    { status: 'Adicionado', process: 'Gerenciar os Registros de Regularização da Operação', subprocess: 'Administrar Documentos Trabalhistas' },
                    { status: 'Adicionado', process: 'Gerenciar os Registros de Regularização da Operação', subprocess: 'Administrar Documentos Regulatórios e Licenças' },
                    { status: 'Adicionado', process: 'Gerenciar os Registros de Regularização da Operação', subprocess: 'Administrar Documentos Contábeis, Fiscais e Tributários' },
                ]
            },
            "Gestão Financeira e Contábil": {
                summary: "A estrutura financeira e contábil foi detalhada, desmembrando 'Contas a Pagar' e 'Contas a Receber' em processos mais específicos e adicionando um controle explícito de processos financeiros. Isso aprimora a granularidade da gestão financeira, permitindo maior controle e visibilidade sobre as operações.",
                changes: [
                    { status: 'Removido', process: 'Gerenciar Contabilidade', subprocess: 'Administrar Contabilidade' },
                    { status: 'Removido', process: 'Gerenciar Contas a Pagar', subprocess: 'Administrar Contas a Pagar' },
                    { status: 'Removido', process: 'Gerenciar Orçamento', subprocess: '—' },
                    { status: 'Removido', process: 'Gerenciar Tesouraria', subprocess: 'Administrar Contas Bancárias' },
                    { status: 'Removido', process: 'Gerenciar Tesouraria', subprocess: 'Administrar Fluxo de Caixa' },
                    { status: 'Adicionado', process: 'Gerenciar Contas a Receber', subprocess: 'Administrar Faturamento dos Serviços de Estágio (IEL)' },
                    { status: 'Adicionado', process: 'Gerenciar Contas a Receber', subprocess: 'Administrar Faturamento dos Serviços de Aprendizagem (IEL)' },
                    { status: 'Adicionado', process: 'Gerenciar Contas a Receber', subprocess: 'Administrar Faturamento dos Demais Serviços (Locação, Energia das Cantinas, Plano de Saúde...)' },
                    { status: 'Adicionado', process: 'Gerenciar Contas a Receber', subprocess: 'Monitorar Arrecação Direta' },
                    { status: 'Adicionado', process: 'Gerenciar Contas a Receber', subprocess: 'Monitorar o Demonstrativo Mensal de Recebimento (Projeto, Fomento, SGF, AL, BNDES, Receita do Compulsório)' },
                    { status: 'Adicionado', process: 'Gerenciar Contas a Pagar', subprocess: 'Administrar Processo de Pagamento de Contratos (Patrocínio, Doação, Locação...)' },
                    { status: 'Adicionado', process: 'Gerenciar Contas a Pagar', subprocess: 'Administrar Processo de Pagamento dos Tributos e Encargos (Fornecedores e Prestadores de Serviços)' },
                    { status: 'Adicionado', process: 'Gerenciar Contas a Pagar', subprocess: 'Administrar Processo de pagamento aos Conselheiros (JETONS)' },
                    { status: 'Adicionado', process: 'Gerenciar Contas a Pagar', subprocess: 'Administrar Demais Processo de Pagamento (Suprimentos, Pagamento Avulso, Pagamento de Viagens, Cessão de Funcionários entre Entidades, Plano de Saúde...)' },
                    { status: 'Adicionado', process: 'Gerenciar Tesouraria', subprocess: 'Administrar Tesouraria' },
                    { status: 'Adicionado', process: 'Gerenciar Tesouraria', subprocess: 'Administrar Fluxo de Caixa' },
                    { status: 'Adicionado', process: 'Controlar processos financeiros', subprocess: 'Monitorar processos Financeiros' },
                    { status: 'Adicionado', process: 'Gerenciar Contabilidade', subprocess: 'Administrar Escrituração Fiscal e Obrigações Acessórias' },
                    { status: 'Adicionado', process: 'Gerenciar Contabilidade', subprocess: 'Administrar Demonstrações Contábeis' },
                    { status: 'Adicionado', process: 'Gerenciar Contabilidade', subprocess: 'Administrar Plano de Contas' },
                ]
            },
            "Gestão Socioambiental": {
                summary: "O portfólio de Gestão Socioambiental foi robustecido, formalizando a gestão de programas ambientais, ações sociais, benefícios e, com especial detalhe, a saúde e segurança do trabalho. Isso demonstra um compromisso crescente com as práticas de ESG (Environmental, Social and Governance).",
                changes: [
                    { status: 'Adicionado', process: 'Gerenciar Ações Ambientais', subprocess: 'Administrar Programas Legais (PGRS e PGRSS) e Ações Ambientais' },
                    { status: 'Adicionado', process: 'Gerenciar Ações Sociais', subprocess: 'Administrar Ações Sociais' },
                    { status: 'Adicionado', process: 'Gerenciar Ações Sociais', subprocess: 'Administrar Programa de Voluntariado' },
                    { status: 'Adicionado', process: 'Gerenciar Benefícios', subprocess: 'Administrar Benefícios' },
                    { status: 'Adicionado', process: 'Gerenciar Saúde e Segurança do Trabalho', subprocess: 'Administrar Absenteísmo' },
                    { status: 'Adicionado', process: 'Gerenciar Saúde e Segurança do Trabalho', subprocess: 'Administrar Programas Legais e Ações de Saúde do Trabalhador' },
                    { status: 'Adicionado', process: 'Gerenciar Saúde e Segurança do Trabalho', subprocess: 'Administrar Programas Legais e Ações de Segurança do Trabalhador' }
                ]
            },
            "Gestão Jurídica": {
                summary: "A inclusão de subprocessos para assessoria e contencioso estrutura as atividades do departamento jurídico, diferenciando o suporte consultivo da gestão de litígios, o que permite um acompanhamento mais especializado e eficiente de ambas as frentes.",
                changes: [
                    { status: 'Adicionado', process: 'Gerenciar Atendimento Jurídico', subprocess: 'Administrar Contencioso' },
                    { status: 'Adicionado', process: 'Gerenciar Atendimento Jurídico', subprocess: 'Realizar Assessoria Jurídica' }
                ]
            },
            "Relacionamento com o Cliente de Segurança e Saúde para Indústria": {
                summary: "Este macroprocesso se manteve estável, indicando a consolidação da jornada do cliente. A estrutura detalhada por tipo de venda (B2B, B2C, B2G) e por serviço (Saúde, Esportes, Segurança) permite uma gestão focada e eficiente.",
                changes: [
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Saúde e Segurança para Indústria', subprocess: 'Administrar Faturamento de Saúde e Segurança para Indústria (Ponto de Venda)' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Saúde e Segurança para Indústria', subprocess: 'Administrar Faturamento dos Serviços de Saúde e Segurança para Indústria' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Saúde e Segurança para Indústria', subprocess: 'Administrar a Recuperação de Crédito de Saúde e Segurança para Indústria' },
                    { status: 'Mantido', process: 'Gerenciar Esportes', subprocess: 'Administrar Serviços de Eventos Esportivos' },
                    { status: 'Mantido', process: 'Gerenciar Esportes', subprocess: 'Administrar Serviços de Locações de Espaços Esportivos' },
                    { status: 'Mantido', process: 'Gerenciar Esportes', subprocess: 'Administrar Serviços de Treinamentos Esportivos' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Administrar ASO' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Administrar Acesso do Paciente / Cliente' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Administrar Consultas / Exames de Saúde' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Administrar Equipamentos Médicos' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Administrar Processamento de Materiais' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Administrar Serviços de Promoção à Saúde' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Administrar Serviços de Saúde Ocupacional (PCMSO, PCA e PERÍCIA)' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Administrar Serviços de Vacina' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Administrar Unidades Móveis' },
                    { status: 'Mantido', process: 'Gerenciar Saúde', subprocess: 'Controlar Materiais e Medicamentos' },
                    { status: 'Mantido', process: 'Gerenciar Segurança no Trabalho', subprocess: 'Administrar Serviços de Educação Corporativa (Treinamentos Normativos)' },
                    { status: 'Mantido', process: 'Gerenciar Segurança no Trabalho', subprocess: 'Administrar Serviços de Segurança no Trabalho (Programas, Laudos e Demais Serviços)' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Esportes', subprocess: 'Realizar Vendas Esportes B2B' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Esportes', subprocess: 'Realizar Vendas Esportes B2C' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Esportes', subprocess: 'Realizar Vendas Esportes B2G' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Saúde', subprocess: 'Realizar Vendas Saúde B2B' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Saúde', subprocess: 'Realizar Vendas Saúde B2C' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Saúde', subprocess: 'Realizar Vendas Saúde B2G' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Segurança no Trabalho', subprocess: 'Administrar Contratos de SSI' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Segurança no Trabalho', subprocess: 'Realizar Vendas Segurança no Trabalho B2B' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Segurança no Trabalho', subprocess: 'Realizar Vendas Segurança no Trabalho B2G' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Saúde e Segurança para Indústria', subprocess: 'Administrar Denúncia de Saúde e Segurança para Indústria' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Saúde e Segurança para Indústria', subprocess: 'Administrar Ouvidoria de Saúde e Segurança para Indústria' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Saúde e Segurança para Indústria', subprocess: 'Administrar Recursos por Negativa de Informação pelo SAC de Saúde e Segurança para Indústria' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Saúde e Segurança para Indústria', subprocess: 'Administrar SAC de Saúde e Segurança para Indústria' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Saúde e Segurança para Indústria', subprocess: 'Realizar Pesquisa de Satisfação do Cliente de Saúde e Segurança para Indústria' },
                    { status: 'Mantido', process: 'Gerenciar o Ciclo de Vida dos Leads de Saúde e Segurança para Indústria', subprocess: 'Administrar Prospecção e Qualificação de Leads de Saúde e Segurança para Indústria' }
                ]
            },
            "Relacionamento com o Cliente de Inovação e Tecnologia": {
                summary: "Este macroprocesso foi refinado e expandido. Subprocessos genéricos foram removidos para dar lugar a um ciclo de vida de serviço mais detalhado. Isso indica uma gestão de portfólio mais madura, com foco no controle e na entrega ponta a ponta dos serviços de tecnologia e inovação.",
                changes: [
                    { status: 'Removido', process: 'Gerenciar Consultorias', subprocess: 'Administrar Serviços de Consultoria' },
                    { status: 'Removido', process: 'Gerenciar Inovação e Empreendedorismos', subprocess: 'Administrar Serviços de Inovação e Empreendedorismos' },
                    { status: 'Removido', process: 'Gerenciar Soluções Digitais', subprocess: 'Administrar Serviços de Soluções Digitais' },
                    { status: 'Removido', process: 'Gerenciar Metrologia', subprocess: 'Administrar Serviços de Metrologia' },
                    { status: 'Removido', process: 'Gerenciar Metrologia', subprocess: 'Executar Serviços de Calibração e Ensaio' },
                    { status: 'Removido', process: 'Gerenciar Inovação e Empreendedorismos', subprocess: 'Implementar e Escalar Soluções Inovadoras' },
                    { status: 'Adicionado', process: 'Gerenciar Consultorias', subprocess: 'Encerrar Serviços de Consultoria' },
                    { status: 'Adicionado', process: 'Gerenciar Consultorias', subprocess: 'Executar Serviços de Consultoria' },
                    { status: 'Adicionado', process: 'Gerenciar Consultorias', subprocess: 'Monitorar e Avaliar Serviços de Consultoria' },
                    { status: 'Adicionado', process: 'Gerenciar Consultorias', subprocess: 'Planejar Serviços de Consultoria' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Inovação e Tecnologia', subprocess: 'Administrar Faturamento de Inovação e Tecnologia (Ponto de Venda)' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Inovação e Tecnologia', subprocess: 'Administrar Faturamento dos Serviços de Inovação e Tecnologia' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Inovação e Tecnologia', subprocess: 'Administrar a Recuperação de Crédito de Inovação e Tecnologia' },
                    { status: 'Adicionado', process: 'Gerenciar Inovação e Empreendedorismos', subprocess: 'Desenvolver Projetos de Inovação' },
                    { status: 'Adicionado', process: 'Gerenciar Inovação e Empreendedorismos', subprocess: 'Implementar Programas de Empreendedorismo Inovador' },
                    { status: 'Adicionado', process: 'Gerenciar Metrologia', subprocess: 'Executar Serviços de Metrologia' },
                    { status: 'Adicionado', process: 'Gerenciar Metrologia', subprocess: 'Monitorar e Controlar a Qualidade dos Serviços de Metrologia' },
                    { status: 'Adicionado', process: 'Gerenciar Metrologia', subprocess: 'Planejar Serviços de Metrologia' },
                    { status: 'Adicionado', process: 'Gerenciar Soluções Digitais', subprocess: 'Desenvolver Soluções Digitais' },
                    { status: 'Adicionado', process: 'Gerenciar Soluções Digitais', subprocess: 'Implementar Soluções Digitais' },
                    { status: 'Adicionado', process: 'Gerenciar Soluções Digitais', subprocess: 'Manter e Suportar Soluções Digitais' },
                    { status: 'Adicionado', process: 'Gerenciar Soluções Digitais', subprocess: 'Planejar o Desenvolvimento de Soluções Digitais' },
                    { status: 'Mantido', process: 'Gerenciar Vendas de Inovação e Tecnologia', subprocess: 'Administrar Contratos de STI' },
                    { status: 'Mantido', process: 'Gerenciar Vendas de Inovação e Tecnologia', subprocess: 'Realizar Vendas Inovação e Tecnologia B2B' },
                    { status: 'Mantido', process: 'Gerenciar Vendas de Inovação e Tecnologia', subprocess: 'Realizar Vendas Inovação e Tecnologia B2G' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Inovação e Tecnologia', subprocess: 'Administrar Denúncia de Inovação e Tecnologia' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Inovação e Tecnologia', subprocess: 'Administrar Ouvidoria de Inovação e Tecnologia' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Inovação e Tecnologia', subprocess: 'Administrar Recursos por Negativa de Informação pelo SAC de Inovação e Tecnologia' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Inovação e Tecnologia', subprocess: 'Administrar SAC de Inovação e Tecnologia' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Inovação e Tecnologia', subprocess: 'Realizar Pesquisa de Satisfação do Cliente de Inovação e Tecnologia' },
                    { status: 'Mantido', process: 'Gerenciar o Ciclo de Vida dos Leads de Inovação e Tecnologia', subprocess: 'Administrar Prospecção e Qualificação de Leads de Inovação e Tecnologia' }
                ]
            },
            "Relacionamento com o Cliente de Educação Profissional": {
                summary: "O portfólio de Educação Profissional foi detalhado, mantendo uma estrutura robusta. A adição de subprocessos específicos para a oferta de serviços e acompanhamento pedagógico demonstra um foco maior na qualidade e na experiência do aluno.",
                changes: [
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Educação Profissional', subprocess: 'Administrar Faturamento de Educação Profissional (Ponto de Venda)' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Educação Profissional', subprocess: 'Administrar Faturamento dos Serviços de Educação Profissional' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Educação Profissional', subprocess: 'Administrar a Recuperação de Crédito de Educação Profissional' },
                    { status: 'Removido', process: 'Gerenciar Oferta dos Serviços de Educação Profissional', subprocess: 'Realizar Gestão da Oferta de Serviços de Educação Profissional para Pessoa Física' },
                    { status: 'Removido', process: 'Gerenciar Oferta dos Serviços de Educação Profissional', subprocess: 'Realizar Gestão da Oferta de Serviços de Educação Profissional para Pessoa Jurídica' },
                    { status: 'Removido', process: 'Gerenciar Oferta dos Serviços de Educação Profissional', subprocess: 'Realizar Gestão da Oferta de Serviços da Aprendizagem Industrial' },
                    { status: 'Adicionado', process: 'Gerenciar Oferta dos Serviços de Educação Profissional', subprocess: 'Realizar Gestão da Oferta de Serviços de Educação Profissional' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Profissional', subprocess: 'Administrar Denúncias de Educação Profissional' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Profissional', subprocess: 'Administrar Ouvidoria de Educação Profissional' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Profissional', subprocess: 'Administrar Recursos por Negativa de Informação pelo SAC de Educação Profissional' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Profissional', subprocess: 'Administrar SAC de Educação Profissional' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Profissional', subprocess: 'Realizar Pesquisa de Satisfação do Cliente de Educação Profissional' },
                    { status: 'Mantido', process: 'Gerenciar o Ciclo de Vida dos Leads de Educação Profissional', subprocess: 'Administrar Prospecção e Qualificação de Leads de Educação Profissional' },
                    { status: 'Mantido', process: 'Planejar Operação de Educação Profissional', subprocess: 'Estruturar Logística para Operação de Serviços de Educação Profissional' },
                    { status: 'Mantido', process: 'Planejar Operação de Educação Profissional', subprocess: 'Estruturar Modelo Pedagógico de Educação Profissional' },
                    { status: 'Mantido', process: 'Planejar Operação de Educação Profissional', subprocess: 'Estruturar Modelo de Operação da Aprendizagem Industrial' },
                    { status: 'Mantido', process: 'Planejar Operação de Educação Profissional', subprocess: 'Preparar Operação de Educação Profissional' },
                    { status: 'Removido', process: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Profissional', subprocess: 'Monitorar Processos de Ensino-Aprendizagem e Avaliação dos serviços de Educação Profissional' },
                    { status: 'Removido', process: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Profissional', subprocess: 'Realizar Processos de Ensino-Aprendizagem de Educação Profissional' },
                    { status: 'Adicionado', process: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Profissional', subprocess: 'Realizar Acompanhamento Pedagógico' },
                    { status: 'Adicionado', process: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Profissional', subprocess: 'Gerenciar Projetos e Programas de Educação Profissional' },
                    { status: 'Mantido', process: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Profissional', subprocess: 'Realizar Certificação Profissional' },
                    { status: 'Removido', process: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Profissional', subprocess: 'Realizar Serviço de Aprendizagem Industrial' },
                    { status: 'Adicionado', process: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Profissional', subprocess: 'Administrar o Relacionamento de Aprendizagem Industrial' },
                    { status: 'Adicionado', process: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Profissional', subprocess: 'Realizar Serviços de Educação Profissional' },
                    { status: 'Adicionado', process: 'Realizar Atendimentos Administrativos de Educação Profissional', subprocess: 'Gerir a Situação Acadêmica do Aluno de Educação Profissional' },
                    { status: 'Adicionado', process: 'Realizar Atendimentos Administrativos de Educação Profissional', subprocess: 'Gerir os Requerimentos de Educação Profissional' },
                    { status: 'Mantido', process: 'Gerenciar Vendas de Educação Profissional', subprocess: 'Administrar Contratos de Educação Profissional' },
                    { status: 'Mantido', process: 'Gerenciar Vendas de Educação Profissional', subprocess: 'Realizar Venda de Educação Profissional B2B' },
                    { status: 'Mantido', process: 'Gerenciar Vendas de Educação Profissional', subprocess: 'Realizar Venda de Educação Profissional B2C' },
                    { status: 'Mantido', process: 'Gerenciar Vendas de Educação Profissional', subprocess: 'Realizar Venda de Educação Profissional B2G' }
                ]
            },
            "Relacionamento com o Cliente de Educação Básica": {
                summary: "A Educação Básica foi amplamente reestruturada. Processos genéricos foram descontinuados para dar lugar a um modelo mais granular, detalhando o ciclo de vida da operação pedagógica (estruturar, preparar, ofertar, monitorar, gerir) para cada modalidade (Regular, EJA, Projetos), buscando maior controle e qualidade.",
                changes: [
                    { status: 'Removido', process: 'Gerenciar Serviço da Educação Básica', subprocess: 'Administrar os Serviços de Educação Básica' },
                    { status: 'Removido', process: 'Gerenciar Serviço da Educação Básica', subprocess: 'Planejar Operação da Educação Básica' },
                    { status: 'Removido', process: 'Gerenciar Serviço da Educação Básica', subprocess: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Educação Básica' },
                    { status: 'Removido', process: 'Gerenciar Serviço da Modalidade de Jovens e Adultos (EJA)', subprocess: 'Planejar Operação da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Removido', process: 'Gerenciar Serviços das Demais Ações Educacionais', subprocess: 'Realizar Processo de Ensino-Aprendizagem, Avaliação, Certificação de Demais Ações de Educação Básica' },
                    { status: 'Adicionado', process: 'Planejar Operação da Educação Básica', subprocess: 'Estruturar Modelo de Operação da Educação Básica' },
                    { status: 'Adicionado', process: 'Planejar Operação da Educação Básica', subprocess: 'Estruturar Modelo Pedagógico da Educação Básica' },
                    { status: 'Adicionado', process: 'Planejar Operação da Educação Básica', subprocess: 'Estruturar Modelo De Projetos E Programas Educacionais da Educação Básica' },
                    { status: 'Adicionado', process: 'Planejar Operação da Educação Básica', subprocess: 'Preparar Operação da Educação Básica' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Educação Básica', subprocess: 'Administrar faturamento dos Serviços de Educação Básica' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Educação Básica', subprocess: 'Administrar Faturamento de Educação Básica (Ponto de Venda)' },
                    { status: 'Mantido', process: 'Gerenciar Contas a Receber de Educação Básica', subprocess: 'Administrar a Recuperação de Crédito de Educação Básica' },
                    { status: 'Adicionado', process: 'Gerenciar oferta dos serviços da Educação Básica', subprocess: 'Ofertar Serviços de Educação Básica' },
                    { status: 'Adicionado', process: 'Realizar atendimentos administrativos da Educação Básica', subprocess: 'Gerir a situação acadêmica do aluno da Educação Básica' },
                    { status: 'Adicionado', process: 'Realizar atendimentos administrativos da Educação Básica', subprocess: 'Gerir os Requerimentos da Educação Básica' },
                    { status: 'Adicionado', process: 'Realizar atendimentos administrativos da Educação Básica', subprocess: 'Realizar gestão de regulação da Educação Básica' },
                    { status: 'Adicionado', process: 'Planejar Operação da Modalidade de Jovens e Adultos (EJA)', subprocess: 'Estruturar Modelo Pedagógico da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Planejar Operação da Modalidade de Jovens e Adultos (EJA)', subprocess: 'Estruturar Modelo de Operação da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Planejar Operação da Modalidade de Jovens e Adultos (EJA)', subprocess: 'Estruturar projetos e programas educacionais da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Planejar Operação da Modalidade de Jovens e Adultos (EJA)', subprocess: 'Preparar Operação da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Gerenciar oferta dos serviços da Modalidade de Jovens e Adultos (EJA)', subprocess: 'Ofertar serviços da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Realizar Processo de ensino-aprendizagem, avaliação, certificação da Modalidade de Jovens e Adultos (EJA)', subprocess: 'Realizar Processos de Ensino-Aprendizagem da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Realizar Processo de ensino-aprendizagem, avaliação, certificação da Modalidade de Jovens e Adultos (EJA)', subprocess: 'Monitorar Processos de Ensino-Aprendizagem e Avaliação dos serviços da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Realizar atendimentos administrativos (EJA)', subprocess: 'Gerir a situação acadêmica do aluno da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Realizar atendimentos administrativos (EJA)', subprocess: 'Gerir os Requerimentos da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Realizar atendimentos administrativos (EJA)', subprocess: 'Realizar gestão de regulação da Modalidade de Jovens e Adultos (EJA)' },
                    { status: 'Adicionado', process: 'Planejar Operação dos Serviços de Projetos E Programas Educacionais', subprocess: 'Estruturar Modelo de Operação de Projetos E Programas Educacionais' },
                    { status: 'Adicionado', process: 'Planejar Operação dos Serviços de Projetos E Programas Educacionais', subprocess: 'Estruturar Modelo Pedagógico de Projetos E Programas Educacionais' },
                    { status: 'Adicionado', process: 'Planejar Operação dos Serviços de Projetos E Programas Educacionais', subprocess: 'Preparar Operação de Projetos E Programas Educacionais' },
                    { status: 'Adicionado', process: 'Gerenciar Oferta dos Serviços de Projetos E Programas Educacionais', subprocess: 'Ofertar Serviços de Projetos E Programas Educacionais' },
                    { status: 'Adicionado', process: 'Realizar Processo de ensino-aprendizagem, avaliação, certificação dos Serviços de Projetos E Programas Educacionais', subprocess: 'Realizar Processos de Ensino-Aprendizagem de Projetos E Programas Educacionais' },
                    { status: 'Adicionado', process: 'Realizar Processo de ensino-aprendizagem, avaliação, certificação dos Serviços de Projetos E Programas Educacionais', subprocess: 'Monitorar Processos de Ensino-Aprendizagem e Avaliação dos serviços de Projetos E Programas Educacionais' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Básica', subprocess: 'Administrar Denúncias de Educação Básica' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Básica', subprocess: 'Administrar Ouvidoria de Educação Básica' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Básica', subprocess: 'Administrar Recursos por Negativa de Informação pelo SAC de Educação Básica' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Básica', subprocess: 'Administrar SAC de Educação Básica' },
                    { status: 'Mantido', process: 'Gerenciar Voz do Cliente de Educação Básica', subprocess: 'Realizar Pesquisa de Satisfação do Cliente de Educação Básica' },
                    { status: 'Mantido', process: 'Gerenciar o Ciclo de Vida dos Leads de Educação Básica', subprocess: 'Administrar Prospecção e Qualificação de Leads de Educação Básica' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Educação Básica', subprocess: 'Administrar Contratos de Educação Básica' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Educação Básica', subprocess: 'Realizar Venda de Educação Básica B2C' },
                    { status: 'Adicionado', process: 'Gerenciar Vendas Educação Básica', subprocess: 'Realizar Venda de Educação Básica B2B' },
                    { status: 'Mantido', process: 'Gerenciar Vendas Educação Básica', subprocess: 'Realizar Venda de Educação Básica B2G' },
                    { status: 'Adicionado', process: 'Realizar Processo de ensino-aprendizagem, avaliação, certificação da educação básica', subprocess: 'Monitorar Processos de Ensino-Aprendizagem e Avaliação dos serviços de Educação Básica' },
                    { status: 'Adicionado', process: 'Realizar Processo de ensino-aprendizagem, avaliação, certificação da educação básica', subprocess: 'Realizar Processos de Ensino-Aprendizagem de Educação Básica' },
                ]
            },
            "Gestão de Marketing": {
                summary: "A Gestão de Marketing foi expandida para cobrir todo o funil, desde a solicitação e planejamento até a criação e execução de demandas. A estrutura agora detalha as diferentes frentes criativas (peças, texto, audiovisual) e canais (e-mail, redes sociais), demonstrando uma operação de marketing mais madura e multifacetada.",
                changes: [
                    { status: 'Mantido', process: 'Gerenciar Comunicação Corporativa', subprocess: 'Administrar Marca' },
                    { status: 'Adicionado', process: 'Gerenciar Solicitações de Marketing', subprocess: 'Administrar Solicitações de Marketing' },
                    { status: 'Adicionado', process: 'Gerenciar Criação do Conceito', subprocess: 'Criar Conceitos' },
                    { status: 'Adicionado', process: 'Gerenciar Plano de Marketing', subprocess: 'Elaborar Plano de Marketing' },
                    { status: 'Adicionado', process: 'Gerenciar Plano de Marketing', subprocess: 'Administrar Plano de Marketing' },
                    { status: 'Adicionado', process: 'Gerenciar Execução Demandas de Marketing', subprocess: 'Administrar Criação de Peças e Artes' },
                    { status: 'Adicionado', process: 'Gerenciar Execução Demandas de Marketing', subprocess: 'Administrar a Produção Textual' },
                    { status: 'Adicionado', process: 'Gerenciar Execução Demandas de Marketing', subprocess: 'Administrar Audiovisual' },
                    { status: 'Adicionado', process: 'Gerenciar Execução Demandas de Marketing', subprocess: 'Administrar Email Marketing' },
                    { status: 'Adicionado', process: 'Gerenciar Execução Demandas de Marketing', subprocess: 'Administrar Desenvolvimento e Integrações' },
                    { status: 'Adicionado', process: 'Gerenciar Execução Demandas de Marketing', subprocess: 'Administrar a Criação de Conteúdos Para Redes Sociais' },
                    { status: 'Adicionado', process: 'Gerenciar Execução Demandas de Marketing', subprocess: 'Administrar Produção de Eventos' }
                ]
            },
            "Gestão de Produto e Cliente": {
                summary: "O macroprocesso de Gestão de Produto e Cliente mantém uma estrutura sólida e sem alterações, cobrindo o ciclo de vida do produto, a experiência do cliente e a inteligência de mercado por meio de pesquisas. A estabilidade aqui é um sinal de maturidade na gestão do portfólio e do relacionamento com o cliente.",
                changes: [
                    { status: 'Mantido', process: 'Gerenciar Portfólio de Produtos', subprocess: 'Administrar Portfólio (Ciclo de Vida do Produto)' },
                    { status: 'Mantido', process: 'Gerenciar Portfólio de Produtos', subprocess: 'Desenvolver Novo Produto' },
                    { status: 'Mantido', process: 'Gerenciar Experiência do Cliente', subprocess: 'Administrar Todos os Pontos de Contatos com o Cliente' },
                    { status: 'Mantido', process: 'Gerenciar Estudos e Pesquisas', subprocess: 'Administrar Estudos e Pesquisas' }
                ]
            },
            "Gestão de Vendas": {
                summary: "A Gestão de Vendas continua focada na administração do plano comercial, um processo central e vital para a geração de receita. A manutenção deste processo indica que a estratégia e a execução comercial estão alinhadas e não necessitaram de reestruturação no último ciclo.",
                changes: [
                    { status: 'Mantido', process: 'Gerenciar Plano Comercial', subprocess: 'Administrar Plano Comercial' }
                ]
            }
        };

        let summaryChart;
        let comparisonChart;

        document.addEventListener('DOMContentLoaded', () => {
            renderComparisonKPIs();
            renderComparisonChart();
            renderChangeSummary();
            renderNavigation();
            renderSummaryChart();
            setupEventListeners();
        });
        
        function renderComparisonKPIs() {
            const container = document.getElementById('comparison-kpis');
            const data = [
                { title: 'Macroprocessos', val2024: 15, val2025: 17 },
                { title: 'Processos', val2024: 91, val2025: 99 },
                { title: 'Subprocessos', val2024: 263, val2025: 277 }
            ];

            container.innerHTML = data.map(item => {
                const diff = item.val2025 - item.val2024;
                const diffClass = diff > 0 ? 'text-emerald-500' : (diff < 0 ? 'text-red-500' : ''); const diffStyle = diff === 0 ? 'color: var(--text-tertiary);' : '';
                const diffSign = diff > 0 ? '+' : '';
                const diffIcon = diff > 0 ? '▲' : (diff < 0 ? '▼' : '▬');

                return `
                    <div class="p-4 rounded-lg text-center" style="background: var(--bg-secondary);">
                        <h4 class="font-semibold" style="color: var(--text-secondary);">${item.title}</h4>
                        <div class="flex justify-around items-center mt-2">
                            <div>
                                <p class="text-2xl font-bold" style="color: var(--text-tertiary);">${item.val2024}</p>
                                 <p class="text-xs" style="color: var(--text-tertiary);">2024</p>
                            </div>
                            <div>
                                <p class="text-3xl font-bold" style="color: var(--primary-600);">${item.val2025}</p>
                                <p class="text-sm font-semibold" style="color: var(--text-secondary);">2025</p>
                            </div>
                        </div>
                        <p class="text-sm font-semibold ${diffClass} mt-3 pt-2 border-t" style="border-color: var(--border-primary); ${diffStyle}">
                            ${diffIcon} ${diffSign}${diff}
                        </p>
                    </div>
                `;
            }).join('');
        }

        function renderComparisonChart() {
            const ctx = document.getElementById('comparison-chart').getContext('2d');
            if (comparisonChart) {
                comparisonChart.destroy();
            }
            
            // Obter cores das variáveis CSS da paleta FIEA
            const rootStyles = getComputedStyle(document.documentElement);
            const primary400 = rootStyles.getPropertyValue('--primary-400').trim(); // #004c98
            const primary200 = rootStyles.getPropertyValue('--primary-200').trim(); // #b3d9ff
            const textSecondary = rootStyles.getPropertyValue('--text-secondary').trim(); // #004c98
            const textTertiary = rootStyles.getPropertyValue('--text-tertiary').trim(); // #666666
            const borderPrimary = rootStyles.getPropertyValue('--border-primary').trim(); // #E0E0E0
            
            comparisonChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: ['Macroprocessos', 'Processos', 'Subprocessos'],
                    datasets: [
                        {
                            label: '2024',
                            data: [15, 91, 263],
                            backgroundColor: `${textTertiary}80`, // #666666 com 50% transparência
                            borderColor: textTertiary, // #666666
                            borderWidth: 1,
                            borderRadius: 4,
                        },
                        {
                            label: '2025',
                            data: [17, 99, 277],
                            backgroundColor: `${primary400}B3`, // #004c98 com 70% transparência
                            borderColor: primary400, // #004c98
                            borderWidth: 1,
                            borderRadius: 4,
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { beginAtZero: true, ticks: { color: textTertiary }, grid: { color: borderPrimary } },
                        x: { ticks: { color: textTertiary }, grid: { display: false } }
                    },
                    plugins: {
                        legend: { position: 'top', labels: { color: textSecondary } },
                        tooltip: { 
                            backgroundColor: textSecondary, // #004c98 - Azul FIEA
                            titleColor: '#FFFFFF',
                            bodyColor: '#FFFFFF',
                            titleFont: { weight: 'bold' }, 
                            bodySpacing: 4, 
                            padding: 10, 
                            cornerRadius: 4,
                            callbacks: {
                                afterBody: function(context) {
                                    const dataIndex = context[0].dataIndex;
                                    const dataset2024 = context[0].chart.data.datasets[0].data[dataIndex];
                                    const dataset2025 = context[0].chart.data.datasets[1].data[dataIndex];
                                    const growth = dataset2025 - dataset2024;
                                    const growthPercent = ((growth / dataset2024) * 100).toFixed(1);
                                    return `Crescimento: ${growth > 0 ? '+' : ''}${growth} (${growthPercent}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        function renderChangeSummary() {
            const container = document.getElementById('change-summary');

            const totals = {
                processes: { added: 23, removed: 15, kept: 76 },
                subprocesses: { added: 99, removed: 87, kept: 178 }
            };

            container.innerHTML = `
                <div class="p-4 rounded-lg" style="background: var(--bg-secondary);">
                    <h3 class="font-bold text-center mb-2" style="color: var(--text-secondary);">Processos</h3>
                    <div class="flex justify-around text-center">
                        <div>
                            <p class="text-2xl font-bold text-emerald-500">${totals.processes.added}</p>
                            <p class="text-xs" style="color: var(--text-tertiary);">Adicionados</p>
                        </div>
                        <div>
                            <p class="text-2xl font-bold text-blue-500">${totals.processes.kept}</p>
                            <p class="text-xs" style="color: var(--text-tertiary);">Mantidos</p>
                        </div>
                        <div>
                            <p class="text-2xl font-bold text-red-500">${totals.processes.removed}</p>
                            <p class="text-xs" style="color: var(--text-tertiary);">Excluídos</p>
                        </div>
                    </div>
                </div>
                <div class="p-4 rounded-lg" style="background: var(--bg-secondary);">
                    <h3 class="font-bold text-center mb-2" style="color: var(--text-secondary);">Subprocessos</h3>
                    <div class="flex justify-around text-center">
                        <div>
                            <p class="text-2xl font-bold text-emerald-500">${totals.subprocesses.added}</p>
                            <p class="text-xs" style="color: var(--text-tertiary);">Adicionados</p>
                        </div>
                        <div>
                            <p class="text-2xl font-bold text-blue-500">${totals.subprocesses.kept}</p>
                            <p class="text-xs" style="color: var(--text-tertiary);">Mantidos</p>
                        </div>
                        <div>
                            <p class="text-2xl font-bold text-red-500">${totals.subprocesses.removed}</p>
                            <p class="text-xs" style="color: var(--text-tertiary);">Excluídos</p>
                        </div>
                    </div>
                </div>
            `;
        }

        function setupEventListeners() {
            // Overlay functionality for mobile (if needed)
            const overlay = document.getElementById('overlay');
            
            if (overlay) {
                overlay.addEventListener('click', () => {
                    const sidebar = document.getElementById('sidebar');
                    if (sidebar) {
                        sidebar.classList.add('sidebar-collapsed');
                        overlay.classList.add('hidden');
                    }
                });
            }
            document.getElementById('back-to-dashboard').addEventListener('click', showDashboardView);
             document.getElementById('back-to-dashboard-from-list').addEventListener('click', showDashboardView);
             document.getElementById('back-to-dashboard-from-history').addEventListener('click', showDashboardView);
        
            // Export buttons
            document.getElementById('export-list-sheets').addEventListener('click', exportListToSheets);
            document.getElementById('export-list-pdf').addEventListener('click', exportListToPDF);
            document.getElementById('export-list-docs').addEventListener('click', exportListToDocs);
            document.getElementById('export-history-pdf').addEventListener('click', exportHistoryToPDF);
            document.getElementById('export-history-docs').addEventListener('click', exportHistoryToDocs);

            // Modal listeners
            document.getElementById('modal-close-btn').addEventListener('click', hideExportModal);
            document.getElementById('export-modal').addEventListener('click', (e) => {
                if (e.target.id === 'export-modal') {
                    hideExportModal();
                }
            });
        }

        function renderNavigation() {
            const navContainer = document.getElementById('navigation');
             navContainer.innerHTML = `
                <div class="nav-item active" data-macro="all">Visão Geral</div>
                <div class="nav-item" data-macro="list">Listagem Completa</div>
                <div class="nav-item" data-macro="history">Histórico de Mudanças</div>
                <hr class="my-2" style="border-color: var(--border-primary);">
                <h3 class="text-xl font-bold mt-4 mb-2 px-2" style="color: var(--primary-700);">Macroprocessos</h3>
            `;
            Object.keys(reportData).sort().forEach(key => {
                const navItem = document.createElement('div');
                navItem.className = 'nav-item';
                navItem.textContent = key;
                navItem.dataset.macro = key;
                navItem.addEventListener('click', () => showDetailView(key));
                navContainer.appendChild(navItem);
            });
            navContainer.querySelector('[data-macro="all"]').addEventListener('click', showDashboardView);
            navContainer.querySelector('[data-macro="list"]').addEventListener('click', showListView);
            navContainer.querySelector('[data-macro="history"]').addEventListener('click', showHistoryView);
        }
        
        function updateActiveNav(macroName) {
            document.querySelectorAll('.nav-item').forEach(item => {
                item.classList.toggle('active', item.dataset.macro === macroName);
            });
        }

        function renderSummaryChart() {
            const ctx = document.getElementById('summary-chart').getContext('2d');
            const labels = Object.keys(reportData).sort();
            const keptData = labels.map(key => reportData[key].changes.filter(c => c.status === 'Mantido').length);
            const addedData = labels.map(key => reportData[key].changes.filter(c => c.status === 'Adicionado').length);
            const removedData = labels.map(key => reportData[key].changes.filter(c => c.status === 'Removido').length);

            if (summaryChart) {
                summaryChart.destroy();
            }
            summaryChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Mantidos', data: keptData, backgroundColor: 'rgba(59, 130, 246, 0.7)', borderWidth: 1, borderRadius: 4 },
                        { label: 'Adicionados', data: addedData, backgroundColor: 'rgba(16, 185, 129, 0.7)', borderWidth: 1, borderRadius: 4 },
                        { label: 'Removidos', data: removedData, backgroundColor: 'rgba(239, 68, 68, 0.7)', borderWidth: 1, borderRadius: 4 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        x: { stacked: true, ticks: { color: '#64748b', autoSkip: false, maxRotation: 90, minRotation: 45 }, grid: { display: false } },
                        y: { stacked: true, beginAtZero: true, ticks: { color: '#64748b' }, grid: { color: '#e2e8f0' } }
                    },
                    plugins: {
                        legend: { position: 'top', labels: { color: '#334155' } },
                        tooltip: { mode: 'index', intersect: false, backgroundColor: '#1e293b', titleFont: { weight: 'bold' }, bodySpacing: 4, padding: 10, cornerRadius: 4 }
                    },
                    onClick: (event, elements) => {
                        if (elements.length > 0) {
                            const index = elements[0].index;
                            const macroName = labels[index];
                            showDetailView(macroName);
                        }
                    },
                    onHover: (event, chartElement) => {
                       event.native.target.style.cursor = chartElement[0] ? 'pointer' : 'default';
                    }
                }
            });
        }
        
        function showDashboardView() {
            document.getElementById('dashboard-view').classList.remove('hidden');
            document.getElementById('detail-view').classList.add('hidden');
            document.getElementById('list-view').classList.add('hidden');
            document.getElementById('history-view').classList.add('hidden');
            updateActiveNav('all');
        }

        function showDetailView(macroName) {
            document.getElementById('dashboard-view').classList.add('hidden');
            document.getElementById('list-view').classList.add('hidden');
            document.getElementById('detail-view').classList.remove('hidden');
            document.getElementById('history-view').classList.add('hidden');
            updateActiveNav(macroName);

            const data = reportData[macroName];
            document.getElementById('detail-title').textContent = macroName;
            document.getElementById('detail-summary').textContent = data.summary;
            
            document.querySelectorAll('#detail-view .filter-btn').forEach(btn => {
                btn.onclick = () => renderTable(macroName, btn.dataset.filter);
            });

            renderTable(macroName, 'all');
            
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('overlay');
            if (window.innerWidth < 768 && !sidebar.classList.contains('-translate-x-full')) {
                 sidebar.classList.add('-translate-x-full');
                 overlay.classList.add('hidden');
            }
        }
        
        function showListView() {
            document.getElementById('dashboard-view').classList.add('hidden');
            document.getElementById('detail-view').classList.add('hidden');
            document.getElementById('list-view').classList.remove('hidden');
            document.getElementById('history-view').classList.add('hidden');
            updateActiveNav('list');

            document.querySelectorAll('#list-view .filter-btn').forEach(btn => {
                btn.onclick = () => renderFullList(btn.dataset.filter);
            });

            renderFullList();
        }

        function showHistoryView() {
            document.getElementById('dashboard-view').classList.add('hidden');
            document.getElementById('detail-view').classList.add('hidden');
            document.getElementById('list-view').classList.add('hidden');
            document.getElementById('history-view').classList.remove('hidden');
            updateActiveNav('history');
        }

        function renderFullList(filter = 'all') {
            const container = document.getElementById('full-list-container');
            if (!container) return;

            document.querySelectorAll('#list-view .filter-btn').forEach(b => {
                b.classList.toggle('active', b.dataset.filter === filter);
                b.classList.toggle('bg-primary-active', b.dataset.filter === filter);
                b.classList.toggle('text-white', b.dataset.filter === filter);
                if (b.dataset.filter !== filter) {
                        b.style.background = 'var(--bg-tertiary)';
                        b.style.color = 'var(--text-secondary)';
                    } else {
                        b.style.background = 'var(--primary-600)';
                        b.style.color = 'white';
                    }
            });

            let html = '';
            const portfolio = {};
            let itemsFound = false;
            
            const allChanges = [];
            Object.keys(reportData).forEach(macro => {
                reportData[macro].changes.forEach(change => {
                    allChanges.push({ ...change, macro });
                });
            });
            
            const filteredChanges = allChanges.filter(change => {
                if (filter === 'all') return true;
                return change.status === filter;
            });

            if (filteredChanges.length > 0) {
                itemsFound = true;
                const groupedByMacro = filteredChanges.reduce((acc, change) => {
                    if (!acc[change.macro]) {
                        acc[change.macro] = {};
                    }
                    if (!acc[change.macro][change.process]) {
                        acc[change.macro][change.process] = [];
                    }
                    acc[change.macro][change.process].push(change);
                    return acc;
                }, {});

                for (const macro in groupedByMacro) {
                    html += `<div class="mb-4"><h3 class="text-lg font-bold" style="color: var(--primary-700);">${macro}</h3>`;
                    html += '<ul class="list-disc list-inside space-y-2 pl-4">';
                    
                    for (const processo in groupedByMacro[macro]) {
                         const processItems = groupedByMacro[macro][processo];
                         const firstItemStatus = processItems[0].status;

                         let processMarker = '';
                         switch(firstItemStatus) {
                            case 'Adicionado': processMarker = '🟩'; break;
                            case 'Mantido': processMarker = '➡️'; break;
                            case 'Removido': processMarker = '❌'; break;
                         }

                        html += `<li><span class="font-semibold" style="color: var(--text-primary);">${processMarker} ${processo}</span>`;

                        const subprocesses = groupedByMacro[macro][processo];
                        if (subprocesses.length > 0 && !(subprocesses.length === 1 && subprocesses[0].subprocess === '—')) {
                            html += '<ul class="list-disc list-inside mt-1 pl-6 space-y-1">';
                            subprocesses.sort((a,b) => a.subprocess.localeCompare(b.subprocess)).forEach(subprocesso => {
                                 let subprocessMarker = '';
                                 switch(subprocesso.status) {
                                    case 'Adicionado': subprocessMarker = '🟩'; break;
                                    case 'Mantido': subprocessMarker = '➡️'; break;
                                    case 'Removido': subprocessMarker = '❌'; break;
                                 }
                                 html += `<li class="text-sm" style="color: var(--text-secondary);">${subprocessMarker} ${subprocesso.subprocess}</li>`;
                            });
                            html += '</ul>';
                        }
                        html += `</li>`;
                    }
                    html += '</ul></div>';
                }
            }
            
            if (!itemsFound) {
                html = '<p class="text-center py-8" style="color: var(--text-tertiary);">Nenhum item encontrado para o status selecionado.</p>';
            }

            container.innerHTML = html;
        }


        function renderTable(macroName, filter) {
            const tableBody = document.getElementById('detail-table-body');
            const data = reportData[macroName];
            
            document.querySelectorAll('#detail-view .filter-btn').forEach(b => {
                b.classList.toggle('active', b.dataset.filter === filter);
                b.classList.toggle('bg-primary-active', b.dataset.filter === filter);
                b.classList.toggle('text-white', b.dataset.filter === filter);
                if (b.dataset.filter !== filter) {
                        b.style.background = 'var(--bg-tertiary)';
                        b.style.color = 'var(--text-secondary)';
                    } else {
                        b.style.background = 'var(--primary-600)';
                        b.style.color = 'white';
                    }
            });

            const filteredChanges = data.changes.filter(change => filter === 'all' || change.status === filter);
            
            if (filteredChanges.length === 0) {
                tableBody.innerHTML = `<tr><td colspan="3" class="px-6 py-4 text-center" style="color: var(--text-tertiary);">Nenhum item encontrado para este filtro.</td></tr>`;
                return;
            }

            tableBody.innerHTML = filteredChanges.map(change => {
                let statusClass, statusIcon;
                switch(change.status) {
                    case 'Adicionado':
                        statusClass = 'bg-emerald-100 text-emerald-800';
                        statusIcon = '🟩';
                        break;
                    case 'Removido':
                        statusClass = 'bg-red-100 text-red-800';
                        statusIcon = '❌';
                        break;
                    default:
                        statusClass = 'bg-blue-100 text-blue-800';
                        statusIcon = '➡️';
                }
                return `
                    <tr style="transition: background-color 0.3s ease;" onmouseover="this.style.background='var(--bg-secondary)';" onmouseout="this.style.background='transparent';">
                        <td class="px-6 py-4 whitespace-nowrap">
                           <span class="px-2 inline-flex text-xs leading-5 font-semibold rounded-full ${statusClass}">
                                ${statusIcon} ${change.status}
                            </span>
                        </td>
                        <td class="px-6 py-4 text-sm font-medium" style="color: var(--text-primary);">${change.process || 'N/A'}</td>
                    <td class="px-6 py-4 text-sm" style="color: var(--text-secondary);">${change.subprocess === '—' ? 'N/A' : change.subprocess}</td>
                    </tr>
                `;
            }).join('');
        }

        // --- EXPORT FUNCTIONS ---

        function getAllProcessData() {
            const allChanges = [];
            Object.keys(reportData).forEach(macro => {
                reportData[macro].changes.forEach(change => {
                    allChanges.push({ ...change, macro });
                });
            });
            return allChanges;
        }

        function getExportContent(filter, type) {
            const data = getAllProcessData().filter(item => filter === 'all' || item.status === filter);
            
            if (type === 'sheets') {
                let tsvContent = "Macroprocesso\tProcesso\tSubprocesso\tStatus\r\n";
                data.forEach(item => {
                    const row = [
                        item.macro,
                        item.process,
                        item.subprocess === '—' ? 'N/A' : item.subprocess,
                        item.status
                    ].join("\t");
                    tsvContent += row + "\r\n";
                });
                return tsvContent;
            }

            if (type === 'docs') {
                 let htmlContent = `
                    <h1>Listagem Completa do Portfólio de Processos (Filtro: ${filter})</h1>
                    <table border="1" style="border-collapse: collapse; width: 100%; font-family: sans-serif;">
                        <thead>
                            <tr style="background-color: #e9e9e9; text-align: left;">
                                <th style="padding: 8px;">Macroprocesso</th>
                                <th style="padding: 8px;">Processo</th>
                                <th style="padding: 8px;">Subprocesso</th>
                                <th style="padding: 8px;">Status</th>
                            </tr>
                        </thead>
                        <tbody>
                `;
                data.forEach(item => {
                    htmlContent += `
                        <tr>
                            <td style="padding: 8px;">${item.macro}</td>
                            <td style="padding: 8px;">${item.process}</td>
                            <td style="padding: 8px;">${item.subprocess === '—' ? 'N/A' : item.subprocess}</td>
                            <td style="padding: 8px;">${item.status}</td>
                        </tr>
                    `;
                });
                htmlContent += `</tbody></table>`;
                return htmlContent;
            }
            return '';
        }

        function showExportModal(title, linkUrl, linkText, exportType, showFilters = false) {
            const modal = document.getElementById('export-modal');
            const modalBox = modal.querySelector('.transform');
            const filterArea = document.getElementById('modal-filter-area');

            document.getElementById('modal-title').textContent = title;
            
            if(showFilters) {
                const filterContainer = document.getElementById('modal-filters');
                filterContainer.innerHTML = `
                    <button data-filter="all" class="modal-filter-btn active bg-primary-active text-white px-3 py-1 rounded-full text-sm font-medium">Todos</button>
                    <button data-filter="Mantido" class="modal-filter-btn px-3 py-1 rounded-full text-sm font-medium transition-all duration-300" style="background: var(--bg-tertiary); color: var(--text-secondary);">Mantidos</button>
                <button data-filter="Adicionado" class="modal-filter-btn px-3 py-1 rounded-full text-sm font-medium transition-all duration-300" style="background: var(--bg-tertiary); color: var(--text-secondary);">Adicionados</button>
                <button data-filter="Removido" class="modal-filter-btn px-3 py-1 rounded-full text-sm font-medium transition-all duration-300" style="background: var(--bg-tertiary); color: var(--text-secondary);">Excluídos</button>
                `;
                filterArea.classList.remove('hidden');

                filterContainer.querySelectorAll('.modal-filter-btn').forEach(btn => {
                    btn.addEventListener('click', () => {
                        filterContainer.querySelectorAll('.modal-filter-btn').forEach(b => {
                            b.classList.remove('active', 'bg-primary-active', 'text-white');
                            b.style.background = 'var(--bg-tertiary)';
                    b.style.color = 'var(--text-secondary)';
                        });
                        btn.classList.add('active', 'bg-primary-active', 'text-white');
                        btn.style.background = 'var(--primary-600)';
                btn.style.color = 'white';
                        updateModalContent(btn.dataset.filter, exportType);
                    });
                });
            } else {
                filterArea.classList.add('hidden');
            }
            
            updateModalContent('all', exportType);

            const linkBtn = document.getElementById('modal-link-btn');
            linkBtn.href = linkUrl;
            linkBtn.textContent = linkText;

            document.getElementById('modal-copy-btn').onclick = (e) => copyFromModal(e);
            
            // Reset copy button state
            const copyBtn = document.getElementById('modal-copy-btn');
            copyBtn.disabled = false;
            copyBtn.innerHTML = `
                <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                Copiar para a Área de Transferência
            `;
            copyBtn.classList.remove('bg-emerald-500');
            copyBtn.style.background = 'var(--primary-500)';

            modal.classList.remove('hidden');
            modal.classList.add('flex');
            setTimeout(() => { // For transition effect
                modal.classList.remove('opacity-0');
                modalBox.classList.remove('scale-95');
            }, 10);
        }

        function updateModalContent(filter, type) {
            const content = getExportContent(filter, type);
            const isHtml = type.includes('docs');
            const contentArea = document.getElementById('modal-content-area');
            contentArea.innerHTML = ''; // Clear previous content

             if (isHtml) {
                contentArea.innerHTML = `<div class="p-4 text-center" style="color: var(--text-secondary);">Conteúdo formatado pronto para ser copiado.</div>`;
                let htmlHolder = document.createElement('div');
                htmlHolder.id = 'html-copy-source';
                htmlHolder.style.position = 'absolute';
                htmlHolder.style.left = '-9999px';
                htmlHolder.innerHTML = content;
                contentArea.appendChild(htmlHolder);
            } else {
                let textArea = document.createElement('textarea');
                textArea.id = 'text-copy-source';
                textArea.className = 'w-full h-48 rounded-md p-2 text-xs'; textArea.style.cssText += '; border: 2px solid var(--primary-200); outline: none;'; textArea.addEventListener('focus', () => { textArea.style.borderColor = 'var(--primary-500)'; textArea.style.boxShadow = '0 0 0 3px rgba(0, 76, 152, 0.1)'; }); textArea.addEventListener('blur', () => { textArea.style.borderColor = 'var(--primary-200)'; textArea.style.boxShadow = 'none'; }); textArea.style.cssText = 'background: var(--bg-secondary); border-color: var(--border-primary); color: var(--text-primary);';
                textArea.readOnly = true;
                textArea.value = content;
                contentArea.appendChild(textArea);
            }
            // Reset copy button state after content update
            const copyBtn = document.getElementById('modal-copy-btn');
             if (copyBtn.disabled) {
                copyBtn.disabled = false;
                copyBtn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"></path></svg>
                    Copiar para a Área de Transferência
                `;
                copyBtn.classList.remove('bg-emerald-500');
                copyBtn.classList.add('bg-teal-500', 'hover:bg-teal-600');
            }
        }
        
        function hideExportModal() {
            const modal = document.getElementById('export-modal');
            const modalBox = modal.querySelector('.transform');
            modal.classList.add('opacity-0');
            modalBox.classList.add('scale-95');
            setTimeout(() => {
                modal.classList.add('hidden');
                modal.classList.remove('flex');
            }, 300); // Match transition duration
        }

        function copyFromModal(event) {
            const textSource = document.getElementById('text-copy-source');
            const htmlSource = document.getElementById('html-copy-source');
            let successful = false;

            if (htmlSource) {
                try {
                    const range = document.createRange();
                    range.selectNodeContents(htmlSource);
                    const selection = window.getSelection();
                    selection.removeAllRanges();
                    selection.addRange(range);
                    successful = document.execCommand('copy');
                    selection.removeAllRanges();
                } catch (err) {
                    console.error('Failed to copy HTML: ', err);
                }
            } else if (textSource) {
                textSource.focus();
                textSource.select();
                try {
                    successful = document.execCommand('copy');
                } catch (err) {
                    console.error('Fallback copy failed: ', err);
                }
            }

            if (successful) {
                const copyBtn = document.getElementById('modal-copy-btn');
                const originalContent = copyBtn.innerHTML;
                copyBtn.disabled = true;
                copyBtn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-5 h-5"><polyline points="20 6 9 17 4 12"></polyline></svg>
                    Copiado!
                `;
                copyBtn.style.background = 'var(--success-500)';
                copyBtn.classList.add('bg-emerald-500');
                
                setTimeout(() => {
                    copyBtn.innerHTML = originalContent;
                    copyBtn.style.background = 'var(--primary-500)';
                    copyBtn.classList.remove('bg-emerald-500');
                    copyBtn.disabled = false;
                }, 2500);
            } else {
                alert('Falha ao copiar. Por favor, copie o texto manualmente (Ctrl+C ou Cmd+C).');
            }
        }

        function exportListToSheets(event) {
            showExportModal(
                'Exportar para Google Sheets',
                'https://sheets.new',
                'Abrir Google Sheets',
                'sheets',
                true // showFilters
            );
        }

        function exportListToPDF() {
            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const data = getAllProcessData();

            const tableData = data.map(item => [
                item.macro,
                item.process,
                item.subprocess === '—' ? 'N/A' : item.subprocess,
                item.status
            ]);

            doc.setFontSize(18);
            doc.text("Listagem Completa do Portfólio de Processos", 14, 22);

            doc.autoTable({
                head: [['Macroprocesso', 'Processo', 'Subprocesso', 'Status']],
                body: tableData,
                startY: 30,
                theme: 'grid',
                headStyles: { fillColor: [13, 148, 136] }, // Teal color from theme
                styles: { fontSize: 8 },
                columnStyles: {
                    0: { cellWidth: 45 },
                    1: { cellWidth: 50 },
                    2: { cellWidth: 'auto' },
                    3: { cellWidth: 20 },
                }
            });

            doc.save("listagem_completa_processos.pdf");
        }

        function exportListToDocs(event) {
            showExportModal(
                'Exportar para Google Docs',
                'https://docs.new',
                'Abrir Google Docs',
                'docs',
                true // showFilters
            );
        }

        function exportHistoryToPDF() {
            const element = document.getElementById('history-content');
            const opt = {
              margin:       [0.5, 0.5, 0.5, 0.5], // top, left, bottom, right
              filename:     'historico_de_mudancas.pdf',
              image:        { type: 'jpeg', quality: 0.98 },
              html2canvas:  { scale: 2, useCORS: true },
              jsPDF:        { unit: 'in', format: 'letter', orientation: 'portrait' }
            };
            html2pdf().from(element).set(opt).save();
        }

        function exportHistoryToDocs(event) {
            const header = `
                <html xmlns:o='urn:schemas-microsoft-com:office:office' xmlns:w='urn:schemas-microsoft-com:office:word' xmlns='http://www.w3.org/TR/REC-html40'>
                <head><meta charset='utf-8'><title>Histórico de Mudanças</title>
                <style>
                    body { font-family: sans-serif; color: #1e293b; }
                    .mb-8 { margin-bottom: 2rem; }
                    .p-4 { padding: 1rem; }
                    .border { border: 1px solid #e2e8f0; }
                    .bg-slate-50 { background-color: #f8fafc; }
                    .rounded-lg { border-radius: 0.5rem; }
                    .text-lg { font-size: 1.125rem; }
                    .font-bold { font-weight: 700; }
                    .bg-primary-active { background-color: var(--primary-500); }
                    .mt-4 { margin-top: 1rem; }
                    .space-y-4 > * + * { margin-top: 1rem; }
                    .font-semibold { font-weight: 600; }

                    .text-sm { font-size: 0.875rem; }
                    .mt-1 { margin-top: 0.25rem; }
                    .font-medium { font-weight: 500; }

                    ul, li { list-style: none; padding-left: 0; }
                </style>
                </head><body>`;
            const footer = "</body></html>";
            const sourceHTML = header + document.getElementById('history-content').innerHTML + footer;
            
            showExportModal(
                'Exportar Histórico para Google Docs',
                'https://docs.new',
                'Abrir Google Docs',
                'history-docs',
                false // showFilters
            );
             updateModalContent(null, 'history-docs'); // This seems wrong, let's fix it.
             const contentArea = document.getElementById('modal-content-area');
             contentArea.innerHTML = `<div class="p-4 text-center" style="color: var(--text-secondary);">Conteúdo formatado pronto para ser copiado.</div>`;
             let htmlHolder = document.createElement('div');
             htmlHolder.id = 'html-copy-source';
             htmlHolder.style.position = 'absolute';
             htmlHolder.style.left = '-9999px';
             htmlHolder.innerHTML = sourceHTML;
             contentArea.appendChild(htmlHolder);
        }

        // Sidebar Toggle Functionality
        document.addEventListener('DOMContentLoaded', function() {
            const sidebarToggle = document.getElementById('sidebar-toggle-header');
            const sidebar = document.getElementById('sidebar');
            const mainContent = document.getElementById('main-content');
            const toggleIcon = document.getElementById('sidebar-toggle-icon-header');
            let sidebarExpanded = true;

            function toggleSidebar() {
                sidebarExpanded = !sidebarExpanded;
                
                if (sidebarExpanded) {
                    // Expand sidebar
                    sidebar.classList.remove('sidebar-collapsed');
                    mainContent.classList.remove('main-expanded');
                    // Update icon rotation for expanded state
                    
                    // Rotate icon to point left
                    toggleIcon.style.transform = 'rotate(0deg)';
                } else {
                    // Collapse sidebar
                    sidebar.classList.add('sidebar-collapsed');
                    mainContent.classList.add('main-expanded');
                    // Update icon rotation for collapsed state
                    
                    // Rotate icon to point right
                    toggleIcon.style.transform = 'rotate(180deg)';
                }
            }

            if (sidebarToggle) {
                sidebarToggle.addEventListener('click', toggleSidebar);
            }

            // Handle responsive behavior
            function handleResize() {
                if (window.innerWidth <= 768) {
                    // Mobile: always collapsed by default
                    if (sidebarExpanded) {
                        sidebar.classList.add('sidebar-collapsed');
                        mainContent.classList.add('main-expanded');
                        // Mobile collapsed state
                        toggleIcon.style.transform = 'rotate(180deg)';
                        sidebarExpanded = false;
                    }
                }
            }

            window.addEventListener('resize', handleResize);
            handleResize(); // Call on load
        });
        
        // Theme Toggle Functionality
        document.addEventListener('DOMContentLoaded', function() {
            const themeToggle = document.getElementById('theme-toggle-header');
            const html = document.documentElement;
            
            // Check for saved theme preference or default to 'light'
            const savedTheme = localStorage.getItem('theme') || 'light';
            
            // Apply saved theme
            if (savedTheme === 'dark') {
                html.setAttribute('data-theme', 'dark');
            } else {
                html.removeAttribute('data-theme');
            }
            
            // Theme toggle event listener
            if (themeToggle) {
                themeToggle.addEventListener('click', function() {
                    const currentTheme = html.getAttribute('data-theme');
                    
                    if (currentTheme === 'dark') {
                        // Switch to light theme
                        html.removeAttribute('data-theme');
                        localStorage.setItem('theme', 'light');
                    } else {
                        // Switch to dark theme
                        html.setAttribute('data-theme', 'dark');
                        localStorage.setItem('theme', 'dark');
                    }
                });
            }
            
            // Listen for system theme changes
            const mediaQuery = window.matchMedia('(prefers-color-scheme: dark)');
            
            function handleSystemThemeChange(e) {
                // Only apply system theme if no user preference is saved
                if (!localStorage.getItem('theme')) {
                    if (e.matches) {
                        html.setAttribute('data-theme', 'dark');
                    } else {
                        html.removeAttribute('data-theme');
                    }
                }
            }
            
            mediaQuery.addEventListener('change', handleSystemThemeChange);
            
            // Apply system theme on first load if no preference saved
            if (!localStorage.getItem('theme') && mediaQuery.matches) {
                html.setAttribute('data-theme', 'dark');
            }
        });
        
        // Fixed Header Functionality
        document.addEventListener('DOMContentLoaded', function() {
            const fixedHeader = document.getElementById('fixed-header');
            const mainContent = document.getElementById('main-content');
            let lastScrollY = window.scrollY;
            let ticking = false;
            
            function updateHeader() {
                const scrollY = window.scrollY;
                
                // Add/remove shadow based on scroll position
                if (scrollY > 10) {
                    fixedHeader.style.boxShadow = 'var(--shadow-lg)';
                    fixedHeader.style.backdropFilter = 'blur(12px)';
                } else {
                    fixedHeader.style.boxShadow = 'var(--shadow-sm)';
                    fixedHeader.style.backdropFilter = 'blur(10px)';
                }
                
                // Optional: Hide header on scroll down, show on scroll up
                // Uncomment the following lines if you want this behavior
                /*
                if (scrollY > lastScrollY && scrollY > 100) {
                    // Scrolling down
                    fixedHeader.style.transform = 'translateY(-100%)';
                } else {
                    // Scrolling up
                    fixedHeader.style.transform = 'translateY(0)';
                }
                */
                
                lastScrollY = scrollY;
                ticking = false;
            }
            
            function requestTick() {
                if (!ticking) {
                    requestAnimationFrame(updateHeader);
                    ticking = true;
                }
            }
            
            // Listen for scroll events
            window.addEventListener('scroll', requestTick, { passive: true });
            
            // Handle responsive behavior
            function handleFixedHeaderResize() {
                const isMobile = window.innerWidth <= 768;
                const headerHeight = fixedHeader.offsetHeight;
                
                // Adjust main content padding based on header height
                if (isMobile) {
                    mainContent.style.paddingTop = `${headerHeight + 16}px`;
                } else {
                    mainContent.style.paddingTop = `${headerHeight + 32}px`;
                }
            }
            
            // Initial setup
            handleFixedHeaderResize();
            
            // Listen for resize events
            window.addEventListener('resize', handleFixedHeaderResize);
            
            // Smooth scroll behavior for internal links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function (e) {
                    e.preventDefault();
                    const target = document.querySelector(this.getAttribute('href'));
                    if (target) {
                        const headerHeight = fixedHeader.offsetHeight;
                        const targetPosition = target.offsetTop - headerHeight - 20;
                        
                        window.scrollTo({
                            top: targetPosition,
                            behavior: 'smooth'
                        });
                    }
                });
            });
        });

    </script>
</body>
</html>